{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"factoryName": {
			"type": "string",
			"metadata": "Data Factory name",
			"defaultValue": "ImportUSDA"
		}
	},
	"variables": {
		"factoryId": "[concat('Microsoft.DataFactory/factories/', parameters('factoryName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('factoryName'), '/FFMOS Utilization')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "3346NFS",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "3347Milk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['report_month']"
										},
										"sink": {
											"name": "Month",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['report_year']"
										},
										"sink": {
											"name": "Year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Pool_order_No']"
										},
										"sink": {
											"name": "PONumber",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jan']"
										},
										"sink": {
											"name": "Jan",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['feb']"
										},
										"sink": {
											"name": "Feb",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['mar']"
										},
										"sink": {
											"name": "Mar",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['apr']"
										},
										"sink": {
											"name": "Apr",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['may']"
										},
										"sink": {
											"name": "May",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jun']"
										},
										"sink": {
											"name": "Jun",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jul']"
										},
										"sink": {
											"name": "Jul",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['aug']"
										},
										"sink": {
											"name": "Aug",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['sep']"
										},
										"sink": {
											"name": "Sep",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['oct']"
										},
										"sink": {
											"name": "Oct",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['nov']"
										},
										"sink": {
											"name": "Nov",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['dec']"
										},
										"sink": {
											"name": "Dec",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total']"
										},
										"sink": {
											"name": "Total",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['slug_id']"
										},
										"sink": {
											"name": "SlugID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['published_date']"
										},
										"sink": {
											"name": "PublishDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['reportSection']"
										},
										"sink": {
											"name": "Section",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['results']",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "3346NFS",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "3351",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "3346ButterFat",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "3346NFS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['report_month']"
										},
										"sink": {
											"name": "Month",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['report_year']"
										},
										"sink": {
											"name": "Year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Pool_order_No']"
										},
										"sink": {
											"name": "PONumber",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jan']"
										},
										"sink": {
											"name": "Jan",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['feb']"
										},
										"sink": {
											"name": "Feb",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['mar']"
										},
										"sink": {
											"name": "Mar",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['apr']"
										},
										"sink": {
											"name": "Apr",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['may']"
										},
										"sink": {
											"name": "May",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jun']"
										},
										"sink": {
											"name": "Jun",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jul']"
										},
										"sink": {
											"name": "Jul",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['aug']"
										},
										"sink": {
											"name": "Aug",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['sep']"
										},
										"sink": {
											"name": "Sep",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['oct']"
										},
										"sink": {
											"name": "Oct",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['nov']"
										},
										"sink": {
											"name": "Nov",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['dec']"
										},
										"sink": {
											"name": "Dec",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total']"
										},
										"sink": {
											"name": "Total",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['slug_id']"
										},
										"sink": {
											"name": "SlugID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['published_date']"
										},
										"sink": {
											"name": "PublishDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['reportSection']"
										},
										"sink": {
											"name": "Section",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['results']",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "3346Butterfat",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "3351",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "3346Milk",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "3346ButterFat",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['report_month']"
										},
										"sink": {
											"name": "Month",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['report_year']"
										},
										"sink": {
											"name": "Year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Pool_order_No']"
										},
										"sink": {
											"name": "PONumber",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jan']"
										},
										"sink": {
											"name": "Jan",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['feb']"
										},
										"sink": {
											"name": "Feb",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['mar']"
										},
										"sink": {
											"name": "Mar",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['apr']"
										},
										"sink": {
											"name": "Apr",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['may']"
										},
										"sink": {
											"name": "May",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jun']"
										},
										"sink": {
											"name": "Jun",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jul']"
										},
										"sink": {
											"name": "Jul",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['aug']"
										},
										"sink": {
											"name": "Aug",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['sep']"
										},
										"sink": {
											"name": "Sep",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['oct']"
										},
										"sink": {
											"name": "Oct",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['nov']"
										},
										"sink": {
											"name": "Nov",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['dec']"
										},
										"sink": {
											"name": "Dec",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total']"
										},
										"sink": {
											"name": "Total",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['slug_id']"
										},
										"sink": {
											"name": "SlugID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['published_date']"
										},
										"sink": {
											"name": "PublishDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['reportSection']"
										},
										"sink": {
											"name": "Section",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['results']",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "3346Milk",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "3351",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "3347NFS",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "3348OtherSolids",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['report_month']"
										},
										"sink": {
											"name": "Month",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['report_year']"
										},
										"sink": {
											"name": "Year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Pool_order_No']"
										},
										"sink": {
											"name": "PONumber",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jan']"
										},
										"sink": {
											"name": "Jan",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['feb']"
										},
										"sink": {
											"name": "Feb",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['mar']"
										},
										"sink": {
											"name": "Mar",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['apr']"
										},
										"sink": {
											"name": "Apr",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['may']"
										},
										"sink": {
											"name": "May",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jun']"
										},
										"sink": {
											"name": "Jun",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jul']"
										},
										"sink": {
											"name": "Jul",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['aug']"
										},
										"sink": {
											"name": "Aug",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['sep']"
										},
										"sink": {
											"name": "Sep",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['oct']"
										},
										"sink": {
											"name": "Oct",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['nov']"
										},
										"sink": {
											"name": "Nov",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['dec']"
										},
										"sink": {
											"name": "Dec",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total']"
										},
										"sink": {
											"name": "Total",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['slug_id']"
										},
										"sink": {
											"name": "SlugID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['published_date']"
										},
										"sink": {
											"name": "PublishDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['reportSection']"
										},
										"sink": {
											"name": "Section",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['results']",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "3347NFS",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "3351",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "3347ButterFat",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "3347NFS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['report_month']"
										},
										"sink": {
											"name": "Month",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['report_year']"
										},
										"sink": {
											"name": "Year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Pool_order_No']"
										},
										"sink": {
											"name": "PONumber",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jan']"
										},
										"sink": {
											"name": "Jan",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['feb']"
										},
										"sink": {
											"name": "Feb",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['mar']"
										},
										"sink": {
											"name": "Mar",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['apr']"
										},
										"sink": {
											"name": "Apr",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['may']"
										},
										"sink": {
											"name": "May",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jun']"
										},
										"sink": {
											"name": "Jun",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jul']"
										},
										"sink": {
											"name": "Jul",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['aug']"
										},
										"sink": {
											"name": "Aug",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['sep']"
										},
										"sink": {
											"name": "Sep",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['oct']"
										},
										"sink": {
											"name": "Oct",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['nov']"
										},
										"sink": {
											"name": "Nov",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['dec']"
										},
										"sink": {
											"name": "Dec",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total']"
										},
										"sink": {
											"name": "Total",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['slug_id']"
										},
										"sink": {
											"name": "SlugID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['published_date']"
										},
										"sink": {
											"name": "PublishDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['reportSection']"
										},
										"sink": {
											"name": "Section",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['results']",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "3347Butterfat",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "3351",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "3347Utilisation",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "3347ButterFat",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['report_month']"
										},
										"sink": {
											"name": "Month",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['report_year']"
										},
										"sink": {
											"name": "Year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Pool_order_No']"
										},
										"sink": {
											"name": "PONumber",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jan']"
										},
										"sink": {
											"name": "Jan",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['feb']"
										},
										"sink": {
											"name": "Feb",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['mar']"
										},
										"sink": {
											"name": "Mar",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['apr']"
										},
										"sink": {
											"name": "Apr",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['may']"
										},
										"sink": {
											"name": "May",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jun']"
										},
										"sink": {
											"name": "Jun",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jul']"
										},
										"sink": {
											"name": "Jul",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['aug']"
										},
										"sink": {
											"name": "Aug",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['sep']"
										},
										"sink": {
											"name": "Sep",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['oct']"
										},
										"sink": {
											"name": "Oct",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['nov']"
										},
										"sink": {
											"name": "Nov",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['dec']"
										},
										"sink": {
											"name": "Dec",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total']"
										},
										"sink": {
											"name": "Total",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['slug_id']"
										},
										"sink": {
											"name": "SlugID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['published_date']"
										},
										"sink": {
											"name": "PublishDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['reportSection']"
										},
										"sink": {
											"name": "Section",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['results']",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "3347Utilization",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "3351",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "3347Milk",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "3347Utilisation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['report_month']"
										},
										"sink": {
											"name": "Month",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['report_year']"
										},
										"sink": {
											"name": "Year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Pool_order_No']"
										},
										"sink": {
											"name": "PONumber",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jan']"
										},
										"sink": {
											"name": "Jan",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['feb']"
										},
										"sink": {
											"name": "Feb",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['mar']"
										},
										"sink": {
											"name": "Mar",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['apr']"
										},
										"sink": {
											"name": "Apr",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['may']"
										},
										"sink": {
											"name": "May",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jun']"
										},
										"sink": {
											"name": "Jun",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jul']"
										},
										"sink": {
											"name": "Jul",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['aug']"
										},
										"sink": {
											"name": "Aug",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['sep']"
										},
										"sink": {
											"name": "Sep",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['oct']"
										},
										"sink": {
											"name": "Oct",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['nov']"
										},
										"sink": {
											"name": "Nov",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['dec']"
										},
										"sink": {
											"name": "Dec",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total']"
										},
										"sink": {
											"name": "Total",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['slug_id']"
										},
										"sink": {
											"name": "SlugID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['published_date']"
										},
										"sink": {
											"name": "PublishDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['reportSection']"
										},
										"sink": {
											"name": "Section",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['results']",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "3347Milk",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "3351",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "3348Milk",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "3349NFS",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['report_month']"
										},
										"sink": {
											"name": "Month",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['report_year']"
										},
										"sink": {
											"name": "Year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Pool_order_No']"
										},
										"sink": {
											"name": "PONumber",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jan']"
										},
										"sink": {
											"name": "Jan",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['feb']"
										},
										"sink": {
											"name": "Feb",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['mar']"
										},
										"sink": {
											"name": "Mar",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['apr']"
										},
										"sink": {
											"name": "Apr",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['may']"
										},
										"sink": {
											"name": "May",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jun']"
										},
										"sink": {
											"name": "Jun",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jul']"
										},
										"sink": {
											"name": "Jul",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['aug']"
										},
										"sink": {
											"name": "Aug",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['sep']"
										},
										"sink": {
											"name": "Sep",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['oct']"
										},
										"sink": {
											"name": "Oct",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['nov']"
										},
										"sink": {
											"name": "Nov",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['dec']"
										},
										"sink": {
											"name": "Dec",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total']"
										},
										"sink": {
											"name": "Total",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['slug_id']"
										},
										"sink": {
											"name": "SlugID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['published_date']"
										},
										"sink": {
											"name": "PublishDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['reportSection']"
										},
										"sink": {
											"name": "Section",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['results']",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "3348Milk",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "3351",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "3348Utilisation",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "3348Milk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['report_month']"
										},
										"sink": {
											"name": "Month",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['report_year']"
										},
										"sink": {
											"name": "Year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Pool_order_No']"
										},
										"sink": {
											"name": "PONumber",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jan']"
										},
										"sink": {
											"name": "Jan",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['feb']"
										},
										"sink": {
											"name": "Feb",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['mar']"
										},
										"sink": {
											"name": "Mar",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['apr']"
										},
										"sink": {
											"name": "Apr",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['may']"
										},
										"sink": {
											"name": "May",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jun']"
										},
										"sink": {
											"name": "Jun",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jul']"
										},
										"sink": {
											"name": "Jul",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['aug']"
										},
										"sink": {
											"name": "Aug",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['sep']"
										},
										"sink": {
											"name": "Sep",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['oct']"
										},
										"sink": {
											"name": "Oct",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['nov']"
										},
										"sink": {
											"name": "Nov",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['dec']"
										},
										"sink": {
											"name": "Dec",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total']"
										},
										"sink": {
											"name": "Total",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['slug_id']"
										},
										"sink": {
											"name": "SlugID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['published_date']"
										},
										"sink": {
											"name": "PublishDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['reportSection']"
										},
										"sink": {
											"name": "Section",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['results']",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "3348Utilization",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "3351",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "3348ButterFat",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "3348Utilisation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['report_month']"
										},
										"sink": {
											"name": "Month",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['report_year']"
										},
										"sink": {
											"name": "Year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Pool_order_No']"
										},
										"sink": {
											"name": "PONumber",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jan']"
										},
										"sink": {
											"name": "Jan",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['feb']"
										},
										"sink": {
											"name": "Feb",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['mar']"
										},
										"sink": {
											"name": "Mar",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['apr']"
										},
										"sink": {
											"name": "Apr",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['may']"
										},
										"sink": {
											"name": "May",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jun']"
										},
										"sink": {
											"name": "Jun",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jul']"
										},
										"sink": {
											"name": "Jul",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['aug']"
										},
										"sink": {
											"name": "Aug",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['sep']"
										},
										"sink": {
											"name": "Sep",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['oct']"
										},
										"sink": {
											"name": "Oct",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['nov']"
										},
										"sink": {
											"name": "Nov",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['dec']"
										},
										"sink": {
											"name": "Dec",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total']"
										},
										"sink": {
											"name": "Total",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['slug_id']"
										},
										"sink": {
											"name": "SlugID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['published_date']"
										},
										"sink": {
											"name": "PublishDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['reportSection']"
										},
										"sink": {
											"name": "Section",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['results']",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "3348Butterfat",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "3351",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "3348Protein",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "3348ButterFat",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['report_month']"
										},
										"sink": {
											"name": "Month",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['report_year']"
										},
										"sink": {
											"name": "Year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Pool_order_No']"
										},
										"sink": {
											"name": "PONumber",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jan']"
										},
										"sink": {
											"name": "Jan",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['feb']"
										},
										"sink": {
											"name": "Feb",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['mar']"
										},
										"sink": {
											"name": "Mar",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['apr']"
										},
										"sink": {
											"name": "Apr",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['may']"
										},
										"sink": {
											"name": "May",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jun']"
										},
										"sink": {
											"name": "Jun",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jul']"
										},
										"sink": {
											"name": "Jul",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['aug']"
										},
										"sink": {
											"name": "Aug",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['sep']"
										},
										"sink": {
											"name": "Sep",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['oct']"
										},
										"sink": {
											"name": "Oct",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['nov']"
										},
										"sink": {
											"name": "Nov",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['dec']"
										},
										"sink": {
											"name": "Dec",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total']"
										},
										"sink": {
											"name": "Total",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['slug_id']"
										},
										"sink": {
											"name": "SlugID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['published_date']"
										},
										"sink": {
											"name": "PublishDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['reportSection']"
										},
										"sink": {
											"name": "Section",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['results']",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "3348Protein",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "3351",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "3348OtherSolids",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "3348Protein",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['report_month']"
										},
										"sink": {
											"name": "Month",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['report_year']"
										},
										"sink": {
											"name": "Year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Pool_order_No']"
										},
										"sink": {
											"name": "PONumber",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jan']"
										},
										"sink": {
											"name": "Jan",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['feb']"
										},
										"sink": {
											"name": "Feb",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['mar']"
										},
										"sink": {
											"name": "Mar",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['apr']"
										},
										"sink": {
											"name": "Apr",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['may']"
										},
										"sink": {
											"name": "May",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jun']"
										},
										"sink": {
											"name": "Jun",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jul']"
										},
										"sink": {
											"name": "Jul",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['aug']"
										},
										"sink": {
											"name": "Aug",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['sep']"
										},
										"sink": {
											"name": "Sep",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['oct']"
										},
										"sink": {
											"name": "Oct",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['nov']"
										},
										"sink": {
											"name": "Nov",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['dec']"
										},
										"sink": {
											"name": "Dec",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total']"
										},
										"sink": {
											"name": "Total",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['slug_id']"
										},
										"sink": {
											"name": "SlugID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['published_date']"
										},
										"sink": {
											"name": "PublishDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['reportSection']"
										},
										"sink": {
											"name": "Section",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['results']",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "3348OtherSolids",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "3351",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "3349Milk",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table pricing.importtable",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['report_month']"
										},
										"sink": {
											"name": "Month",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['report_year']"
										},
										"sink": {
											"name": "Year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Pool_order_No']"
										},
										"sink": {
											"name": "PONumber",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jan']"
										},
										"sink": {
											"name": "Jan",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['feb']"
										},
										"sink": {
											"name": "Feb",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['mar']"
										},
										"sink": {
											"name": "Mar",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['apr']"
										},
										"sink": {
											"name": "Apr",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['may']"
										},
										"sink": {
											"name": "May",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jun']"
										},
										"sink": {
											"name": "Jun",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jul']"
										},
										"sink": {
											"name": "Jul",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['aug']"
										},
										"sink": {
											"name": "Aug",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['sep']"
										},
										"sink": {
											"name": "Sep",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['oct']"
										},
										"sink": {
											"name": "Oct",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['nov']"
										},
										"sink": {
											"name": "Nov",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['dec']"
										},
										"sink": {
											"name": "Dec",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total']"
										},
										"sink": {
											"name": "Total",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['slug_id']"
										},
										"sink": {
											"name": "SlugID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['published_date']"
										},
										"sink": {
											"name": "PublishDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['reportSection']"
										},
										"sink": {
											"name": "Section",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['results']",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "3349Milk",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "3351",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "3349Utilisation",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "3349Milk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['report_month']"
										},
										"sink": {
											"name": "Month",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['report_year']"
										},
										"sink": {
											"name": "Year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Pool_order_No']"
										},
										"sink": {
											"name": "PONumber",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jan']"
										},
										"sink": {
											"name": "Jan",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['feb']"
										},
										"sink": {
											"name": "Feb",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['mar']"
										},
										"sink": {
											"name": "Mar",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['apr']"
										},
										"sink": {
											"name": "Apr",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['may']"
										},
										"sink": {
											"name": "May",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jun']"
										},
										"sink": {
											"name": "Jun",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jul']"
										},
										"sink": {
											"name": "Jul",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['aug']"
										},
										"sink": {
											"name": "Aug",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['sep']"
										},
										"sink": {
											"name": "Sep",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['oct']"
										},
										"sink": {
											"name": "Oct",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['nov']"
										},
										"sink": {
											"name": "Nov",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['dec']"
										},
										"sink": {
											"name": "Dec",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total']"
										},
										"sink": {
											"name": "Total",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['slug_id']"
										},
										"sink": {
											"name": "SlugID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['published_date']"
										},
										"sink": {
											"name": "PublishDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['reportSection']"
										},
										"sink": {
											"name": "Section",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['results']",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "3349Utilization",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "3351",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "3349ButterFat",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "3349Utilisation",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['report_month']"
										},
										"sink": {
											"name": "Month",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['report_year']"
										},
										"sink": {
											"name": "Year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Pool_order_No']"
										},
										"sink": {
											"name": "PONumber",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jan']"
										},
										"sink": {
											"name": "Jan",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['feb']"
										},
										"sink": {
											"name": "Feb",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['mar']"
										},
										"sink": {
											"name": "Mar",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['apr']"
										},
										"sink": {
											"name": "Apr",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['may']"
										},
										"sink": {
											"name": "May",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jun']"
										},
										"sink": {
											"name": "Jun",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jul']"
										},
										"sink": {
											"name": "Jul",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['aug']"
										},
										"sink": {
											"name": "Aug",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['sep']"
										},
										"sink": {
											"name": "Sep",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['oct']"
										},
										"sink": {
											"name": "Oct",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['nov']"
										},
										"sink": {
											"name": "Nov",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['dec']"
										},
										"sink": {
											"name": "Dec",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total']"
										},
										"sink": {
											"name": "Total",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['slug_id']"
										},
										"sink": {
											"name": "SlugID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['published_date']"
										},
										"sink": {
											"name": "PublishDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['reportSection']"
										},
										"sink": {
											"name": "Section",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['results']",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "3349Butterfat",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "3351",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "3349NFS",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "3349ButterFat",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['report_month']"
										},
										"sink": {
											"name": "Month",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['report_year']"
										},
										"sink": {
											"name": "Year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Pool_order_No']"
										},
										"sink": {
											"name": "PONumber",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jan']"
										},
										"sink": {
											"name": "Jan",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['feb']"
										},
										"sink": {
											"name": "Feb",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['mar']"
										},
										"sink": {
											"name": "Mar",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['apr']"
										},
										"sink": {
											"name": "Apr",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['may']"
										},
										"sink": {
											"name": "May",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jun']"
										},
										"sink": {
											"name": "Jun",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jul']"
										},
										"sink": {
											"name": "Jul",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['aug']"
										},
										"sink": {
											"name": "Aug",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['sep']"
										},
										"sink": {
											"name": "Sep",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['oct']"
										},
										"sink": {
											"name": "Oct",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['nov']"
										},
										"sink": {
											"name": "Nov",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['dec']"
										},
										"sink": {
											"name": "Dec",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total']"
										},
										"sink": {
											"name": "Total",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['slug_id']"
										},
										"sink": {
											"name": "SlugID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['published_date']"
										},
										"sink": {
											"name": "PublishDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['reportSection']"
										},
										"sink": {
											"name": "Section",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['results']",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "3349NFS",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "3351",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "3346Utilisation",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "3346Milk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['report_month']"
										},
										"sink": {
											"name": "Month",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['report_year']"
										},
										"sink": {
											"name": "Year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Pool_Order_Name']"
										},
										"sink": {
											"name": "POName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Pool_order_No']"
										},
										"sink": {
											"name": "PONumber",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jan']"
										},
										"sink": {
											"name": "Jan",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['feb']"
										},
										"sink": {
											"name": "Feb",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['mar']"
										},
										"sink": {
											"name": "Mar",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['apr']"
										},
										"sink": {
											"name": "Apr",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['may']"
										},
										"sink": {
											"name": "May",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jun']"
										},
										"sink": {
											"name": "Jun",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jul']"
										},
										"sink": {
											"name": "Jul",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['aug']"
										},
										"sink": {
											"name": "Aug",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['sep']"
										},
										"sink": {
											"name": "Sep",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['oct']"
										},
										"sink": {
											"name": "Oct",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['nov']"
										},
										"sink": {
											"name": "Nov",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['dec']"
										},
										"sink": {
											"name": "Dec",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total']"
										},
										"sink": {
											"name": "Total",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['slug_id']"
										},
										"sink": {
											"name": "SlugID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['published_date']"
										},
										"sink": {
											"name": "PublishDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['reportSection']"
										},
										"sink": {
											"name": "Section",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['results']",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "3346Utilization",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "3351",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/FMMOS Milk Pricing')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "3351Milk",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['report_month']"
										},
										"sink": {
											"name": "Month",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['report_year']"
										},
										"sink": {
											"name": "Year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Pool_order_No']"
										},
										"sink": {
											"name": "PONumber",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jan']"
										},
										"sink": {
											"name": "Jan",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['feb']"
										},
										"sink": {
											"name": "Feb",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['mar']"
										},
										"sink": {
											"name": "Mar",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['apr']"
										},
										"sink": {
											"name": "Apr",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['may']"
										},
										"sink": {
											"name": "May",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jun']"
										},
										"sink": {
											"name": "Jun",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jul']"
										},
										"sink": {
											"name": "Jul",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['aug']"
										},
										"sink": {
											"name": "Aug",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['sep']"
										},
										"sink": {
											"name": "Sep",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['oct']"
										},
										"sink": {
											"name": "Oct",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['nov']"
										},
										"sink": {
											"name": "Nov",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['dec']"
										},
										"sink": {
											"name": "Dec",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total']"
										},
										"sink": {
											"name": "Total",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['slug_id']"
										},
										"sink": {
											"name": "SlugID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['published_date']"
										},
										"sink": {
											"name": "PublishDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['reportSection']"
										},
										"sink": {
											"name": "Section",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['results']",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "3351Milk",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "3351",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "3351PPD",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "3351Milk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['report_month']"
										},
										"sink": {
											"name": "Month",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['report_year']"
										},
										"sink": {
											"name": "Year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Pool_order_No']"
										},
										"sink": {
											"name": "PONumber",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jan']"
										},
										"sink": {
											"name": "Jan",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['feb']"
										},
										"sink": {
											"name": "Feb",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['mar']"
										},
										"sink": {
											"name": "Mar",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['apr']"
										},
										"sink": {
											"name": "Apr",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['may']"
										},
										"sink": {
											"name": "May",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jun']"
										},
										"sink": {
											"name": "Jun",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['jul']"
										},
										"sink": {
											"name": "Jul",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['aug']"
										},
										"sink": {
											"name": "Aug",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['sep']"
										},
										"sink": {
											"name": "Sep",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['oct']"
										},
										"sink": {
											"name": "Oct",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['nov']"
										},
										"sink": {
											"name": "Nov",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['dec']"
										},
										"sink": {
											"name": "Dec",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['total']"
										},
										"sink": {
											"name": "Total",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['slug_id']"
										},
										"sink": {
											"name": "SlugID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['published_date']"
										},
										"sink": {
											"name": "PublishDate",
											"type": "DateTime"
										}
									},
									{
										"source": {
											"path": "$['reportSection']"
										},
										"sink": {
											"name": "Section",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['results']",
								"mapComplexValuesToString": false
							}
						},
						"inputs": [
							{
								"referenceName": "3351PPD",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "3351",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "3354",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "3351PPD",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table pricing.imp3354",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "$['reportSection']"
										},
										"sink": {
											"name": "Section",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['report_month']"
										},
										"sink": {
											"name": "Month",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['report_year']"
										},
										"sink": {
											"name": "Year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['order_no']"
										},
										"sink": {
											"name": "PONumber",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Price_Whole']"
										},
										"sink": {
											"name": "Whole",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Price_Skim']"
										},
										"sink": {
											"name": "Skim",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Price_Butterfat']"
										},
										"sink": {
											"name": "Butterfat",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['slug_id']"
										},
										"sink": {
											"name": "SlugID",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "$['results'][0]['published_date']"
										},
										"sink": {
											"name": "PublishDate",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['results']"
							}
						},
						"inputs": [
							{
								"referenceName": "3354",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "imp3354",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Futures Pipeline')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "datecheck",
						"type": "Lookup",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "AzureSqlSource",
								"sqlReaderStoredProcedureName": "[[dbo].[FuturesYesNo]",
								"storedProcedureParameters": {
									"YesNo": {
										"type": "String",
										"value": "no"
									}
								},
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"dataset": {
								"referenceName": "checkdate",
								"type": "DatasetReference",
								"parameters": {}
							}
						}
					},
					{
						"name": "datecheckvar",
						"type": "SetVariable",
						"dependsOn": [
							{
								"activity": "datecheck",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"variableName": "DateCheckVar",
							"value": {
								"value": "@activity('datecheck').output.firstRow.answer",
								"type": "Expression"
							}
						}
					},
					{
						"name": "If Condition1",
						"type": "IfCondition",
						"dependsOn": [
							{
								"activity": "datecheckvar",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"userProperties": [],
						"typeProperties": {
							"expression": {
								"value": "@equals(variables('DateCheckVar'),'Yes')",
								"type": "Expression"
							},
							"ifTrueActivities": [
								{
									"name": "FuturesBlob_copy1",
									"type": "Copy",
									"dependsOn": [
										{
											"activity": "Futures LogicApp WebHook_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"source": {
											"type": "ExcelSource",
											"storeSettings": {
												"type": "AzureBlobStorageReadSettings",
												"recursive": true,
												"enablePartitionDiscovery": false
											}
										},
										"sink": {
											"type": "AzureSqlSink",
											"preCopyScript": "truncate table futuresimp\n",
											"writeBehavior": "insert",
											"sqlWriterUseTableLock": false,
											"tableOption": "autoCreate",
											"disableMetricsCollection": false
										},
										"enableStaging": false,
										"translator": {
											"type": "TabularTranslator",
											"mappings": [
												{
													"source": {
														"name": "Contract",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "Contract",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "Description",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "Description",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "Source",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "Source",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "Month",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "Month",
														"type": "String",
														"physicalType": "nvarchar"
													}
												},
												{
													"source": {
														"name": "Year",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "Year",
														"type": "Int32",
														"physicalType": "int"
													}
												},
												{
													"source": {
														"name": "Price",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "Price",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 2,
														"precision": 18
													}
												},
												{
													"source": {
														"name": "Price_Lb",
														"type": "String",
														"physicalType": "String"
													},
													"sink": {
														"name": "PriceLb",
														"type": "Decimal",
														"physicalType": "decimal",
														"scale": 5,
														"precision": 18
													}
												}
											],
											"typeConversion": true,
											"typeConversionSettings": {
												"allowDataTruncation": true,
												"treatBooleanAsNumber": false
											}
										}
									},
									"inputs": [
										{
											"referenceName": "FuturesBlob",
											"type": "DatasetReference",
											"parameters": {}
										}
									],
									"outputs": [
										{
											"referenceName": "FuturesImp",
											"type": "DatasetReference",
											"parameters": {}
										}
									]
								},
								{
									"name": "Futures LogicApp WebHook_copy1",
									"type": "WebHook",
									"dependsOn": [],
									"userProperties": [],
									"typeProperties": {
										"url": "https://prod-15.westus.logic.azure.com:443/workflows/dbe0895afdca41918cc5a002c1a2c138/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=vJPcVEvH6olmcdFW8O9tCBccc2i0JpNAom4qYNzEpBw",
										"method": "POST",
										"headers": {
											"Content-Type": "application/json"
										},
										"body": {
											"DataFactoryName": "@{pipeline().DataFactory}",
											"PipelineName": "@{pipeline().Pipeline}"
										},
										"timeout": "00:10:00"
									}
								},
								{
									"name": "FuturesCalcs",
									"type": "SqlServerStoredProcedure",
									"dependsOn": [
										{
											"activity": "FuturesBlob_copy1",
											"dependencyConditions": [
												"Succeeded"
											]
										}
									],
									"policy": {
										"timeout": "0.12:00:00",
										"retry": 0,
										"retryIntervalInSeconds": 30,
										"secureOutput": false,
										"secureInput": false
									},
									"userProperties": [],
									"typeProperties": {
										"storedProcedureName": "[[dbo].[FuturesProcedure]"
									},
									"linkedServiceName": {
										"referenceName": "Sara Database",
										"type": "LinkedServiceReference"
									}
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"variables": {
					"TimeSTamp": {
						"type": "String"
					},
					"DateCheckVar": {
						"type": "String"
					}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/GTT Trade 2')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "part 2",
				"activities": [
					{
						"name": "040690E",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "rename table 040690D",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table GTTImportCurrent\nexec sp_rename 'GTT040690E','Temp1'\n",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['tradeFlow']"
										},
										"sink": {
											"name": "tradeFlow",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "year",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['month']"
										},
										"sink": {
											"name": "month",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['reporterCode']"
										},
										"sink": {
											"name": "reporterCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reporterName']"
										},
										"sink": {
											"name": "reporterName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerCode']"
										},
										"sink": {
											"name": "partnerCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerName']"
										},
										"sink": {
											"name": "partnerName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['hsCode']"
										},
										"sink": {
											"name": "hsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['value']"
										},
										"sink": {
											"name": "value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['unit1']"
										},
										"sink": {
											"name": "unit1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['quantity1']"
										},
										"sink": {
											"name": "quantity1",
											"type": "Double"
										}
									}
								],
								"collectionReference": "$['reportData']"
							}
						},
						"inputs": [
							{
								"referenceName": "GTT040690E",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GTTImportCurrent",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "rename table 040690E",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Run Prep and Calcs 040690E",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "EXEC sp_rename 'Temp1','GTT040690E'\n\ntruncate table GTT040690E_BI\n\ninsert Into GTT040690E_BI(date,FlowType,Year,Month,Reporter,Partner,Code,FourDigit,SixDigit,Item,Commodity,\nClass,Volume,Unit,Value,Currency,lb,normval,normlbs,MOMPerc,MOMActualLbs,MOMNormLbs,\nYOYPerc,YOYActualLbs,YOYNormLbs,YTDPerc,YTDActualLbs,YTDNormLbs,Avg5Year,Avg5YearVol)\n\nselect GTT040690E.Date,GTT040690E.FlowType,GTT040690E.Year,GTT040690E.Month,\nGTT040690E.Declarant,GTT040690E.Partner,GTT040690E.Code,ItemTable.FourDigit,ItemTable.SixDigit,\nGTT040690E.item,CommodityTable.Commodity,ClassTable.Class,GTT040690E.Volume,GTT040690E.Unit,GTT040690E.Value,\nGTT040690E.Currency,GTT040690E.LB,GTT040690E.NormVal,GTT040690E.Normlbs,GTT040690E.MOMPerc,\nGTT040690E.MOMActualLbs,MOMNormLbs,GTT040690E.YOYPerc,GTT040690E.YOYActualLbs,GTT040690E.YOYNormLbs,\nGTT040690E.YTDperc,GTT040690E.YTDActualLbs,GTT040690E.YTDNormLbs,GTT040690E.Avg5Year,\nGTT040690E.Avg5YearVol \n\nFrom \n\nGTT040690E Inner Join ItemTable on GTT040690E.Code = ItemTable.TradeCode \nInner Join CommodityTable on ItemTable.Commodity = CommodityTable.CommodityID\nInner Join ClassTable on ItemTable.Class = ClassTable.ClassID\n\n"
								}
							]
						}
					},
					{
						"name": "Run Prep and Calcs 040690E",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "040690E",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[GTTImportPrep]"
						},
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "040690D",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "rename table 040690C",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table GTTImportCurrent\nexec sp_rename 'GTT040690D','Temp1'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['tradeFlow']"
										},
										"sink": {
											"name": "tradeFlow",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "year",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['month']"
										},
										"sink": {
											"name": "month",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['reporterCode']"
										},
										"sink": {
											"name": "reporterCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reporterName']"
										},
										"sink": {
											"name": "reporterName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerCode']"
										},
										"sink": {
											"name": "partnerCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerName']"
										},
										"sink": {
											"name": "partnerName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['hsCode']"
										},
										"sink": {
											"name": "hsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['value']"
										},
										"sink": {
											"name": "value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['unit1']"
										},
										"sink": {
											"name": "unit1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['quantity1']"
										},
										"sink": {
											"name": "quantity1",
											"type": "Double"
										}
									}
								],
								"collectionReference": "$['reportData']"
							}
						},
						"inputs": [
							{
								"referenceName": "GTT040690D",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GTTImportCurrent",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Run Prep and Calcs 040690D",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "040690D",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[GTTImportPrep]"
						},
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "rename table 040690D",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Run Prep and Calcs 040690D",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "EXEC sp_rename 'Temp1','GTT040690D'\n\ntruncate table GTT040690E_BI\n\ninsert Into GTT040690E_BI(date,FlowType,Year,Month,Reporter,Partner,Code,FourDigit,SixDigit,Item,Commodity,\nClass,Volume,Unit,Value,Currency,lb,normval,normlbs,MOMPerc,MOMActualLbs,MOMNormLbs,\nYOYPerc,YOYActualLbs,YOYNormLbs,YTDPerc,YTDActualLbs,YTDNormLbs,Avg5Year,Avg5YearVol)\n\nselect GTT040690E.Date,GTT040690E.FlowType,GTT040690E.Year,GTT040690E.Month,\nGTT040690E.Declarant,GTT040690E.Partner,GTT040690E.Code,ItemTable.FourDigit,ItemTable.SixDigit,\nGTT040690E.item,CommodityTable.Commodity,ClassTable.Class,GTT040690E.Volume,GTT040690E.Unit,GTT040690E.Value,\nGTT040690E.Currency,GTT040690E.LB,GTT040690E.NormVal,GTT040690E.Normlbs,GTT040690E.MOMPerc,\nGTT040690E.MOMActualLbs,MOMNormLbs,GTT040690E.YOYPerc,GTT040690E.YOYActualLbs,GTT040690E.YOYNormLbs,\nGTT040690E.YTDperc,GTT040690E.YTDActualLbs,GTT040690E.YTDNormLbs,GTT040690E.Avg5Year,\nGTT040690E.Avg5YearVol \n\nFrom \n\nGTT040690E Inner Join ItemTable on GTT040690E.Code = ItemTable.TradeCode \nInner Join CommodityTable on ItemTable.Commodity = CommodityTable.CommodityID\nInner Join ClassTable on ItemTable.Class = ClassTable.ClassID\n\n"
								}
							]
						}
					},
					{
						"name": "040690C",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "rename table 040690B",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table GTTImportCurrent\nexec sp_rename 'GTT040690C','Temp1'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['tradeFlow']"
										},
										"sink": {
											"name": "tradeFlow",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "year",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['month']"
										},
										"sink": {
											"name": "month",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['reporterCode']"
										},
										"sink": {
											"name": "reporterCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reporterName']"
										},
										"sink": {
											"name": "reporterName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerCode']"
										},
										"sink": {
											"name": "partnerCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerName']"
										},
										"sink": {
											"name": "partnerName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['hsCode']"
										},
										"sink": {
											"name": "hsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['value']"
										},
										"sink": {
											"name": "value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['unit1']"
										},
										"sink": {
											"name": "unit1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['quantity1']"
										},
										"sink": {
											"name": "quantity1",
											"type": "Double"
										}
									}
								],
								"collectionReference": "$['reportData']"
							}
						},
						"inputs": [
							{
								"referenceName": "gtt040690C",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GTTImportCurrent",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Run Prep and Calcs 040690C",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "040690C",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[GTTImportPrep]"
						},
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "rename table 040690C",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Run Prep and Calcs 040690C",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "EXEC sp_rename 'Temp1','GTT040690C'\n\ntruncate table GTT040690C_BI\n\ninsert Into GTT040690C_BI(date,FlowType,Year,Month,Reporter,Partner,Code,FourDigit,SixDigit,Item,Commodity,\nClass,Volume,Unit,Value,Currency,lb,normval,normlbs,MOMPerc,MOMActualLbs,MOMNormLbs,\nYOYPerc,YOYActualLbs,YOYNormLbs,YTDPerc,YTDActualLbs,YTDNormLbs,Avg5Year,Avg5YearVol)\n\nselect GTT040690C.Date, GTT040690C.FlowType, GTT040690C.Year, GTT040690C.Month,\nGTT040690C.Declarant, GTT040690C.Partner, GTT040690C.Code,ItemTable.FourDigit,ItemTable.SixDigit,\nGTT040690C.item,CommodityTable.Commodity,ClassTable.Class, GTT040690C.Volume, GTT040690C.Unit, GTT040690C.Value,\nGTT040690C.Currency, GTT040690C.LB, GTT040690C.NormVal, GTT040690C.Normlbs, GTT040690C.MOMPerc,\nGTT040690C.MOMActualLbs,MOMNormLbs, GTT040690C.YOYPerc, GTT040690C.YOYActualLbs, GTT040690C.YOYNormLbs,\nGTT040690C.YTDperc, GTT040690C.YTDActualLbs, GTT040690C.YTDNormLbs, GTT040690C.Avg5Year,\nGTT040690C.Avg5YearVol \n\nFrom \n\nGTT040690C Inner Join ItemTable on GTT040690C.Code = ItemTable.TradeCode \nInner Join CommodityTable on ItemTable.Commodity = CommodityTable.CommodityID\nInner Join ClassTable on ItemTable.Class = ClassTable.ClassID\n"
								}
							]
						}
					},
					{
						"name": "040690B",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "rename table 040690",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table GTTImportCurrent\nexec sp_rename 'GTT040690B','Temp1'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['tradeFlow']"
										},
										"sink": {
											"name": "tradeFlow",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "year",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['month']"
										},
										"sink": {
											"name": "month",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['reporterCode']"
										},
										"sink": {
											"name": "reporterCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reporterName']"
										},
										"sink": {
											"name": "reporterName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerCode']"
										},
										"sink": {
											"name": "partnerCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerName']"
										},
										"sink": {
											"name": "partnerName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['hsCode']"
										},
										"sink": {
											"name": "hsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['value']"
										},
										"sink": {
											"name": "value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['unit1']"
										},
										"sink": {
											"name": "unit1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['quantity1']"
										},
										"sink": {
											"name": "quantity1",
											"type": "Double"
										}
									}
								],
								"collectionReference": "$['reportData']"
							}
						},
						"inputs": [
							{
								"referenceName": "GTT040690B",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GTTImportCurrent",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Run Prep and Calcs 040690B",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "040690B",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[GTTImportPrep]"
						},
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "rename table 040690B",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Run Prep and Calcs 040690B",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "EXEC sp_rename 'Temp1','GTT040690B'\n\ntruncate table GTT040690B_BI\n\nGTT040690B_BI(date,FlowType,Year,Month,Reporter,Partner,Code,FourDigit,SixDigit,Item,Commodity,\nClass,Volume,Unit,Value,Currency,lb,normval,normlbs,MOMPerc,MOMActualLbs,MOMNormLbs,\nYOYPerc,YOYActualLbs,YOYNormLbs,YTDPerc,YTDActualLbs,YTDNormLbs,Avg5Year,Avg5YearVol)\n\nselect GTT040690B.Date, GTT040690B.FlowType, GTT040690B.Year, GTT040690B.Month,\nGTT040690B.Declarant, GTT040690B.Partner, GTT040690B.Code,ItemTable.FourDigit,ItemTable.SixDigit,\nGTT040690B.item,CommodityTable.Commodity,ClassTable.Class, GTT040690B.Volume, GTT040690B.Unit, GTT040690B.Value,\nGTT040690B.Currency, GTT040690B.LB, GTT040690B.NormVal, GTT040690B.Normlbs, GTT040690B.MOMPerc,\nGTT040690B.MOMActualLbs,MOMNormLbs, GTT040690B.YOYPerc, GTT040690B.YOYActualLbs, GTT040690B.YOYNormLbs,\nGTT040690B.YTDperc, GTT040690B.YTDActualLbs, GTT040690B.YTDNormLbs, GTT040690B.Avg5Year,\nGTT040690B.Avg5YearVol \n\nFrom \n\nGTT040690B Inner Join ItemTable on GTT040690B.Code = ItemTable.TradeCode \nInner Join CommodityTable on ItemTable.Commodity = CommodityTable.CommodityID\nInner Join ClassTable on ItemTable.Class = ClassTable.ClassID\n"
								}
							]
						}
					},
					{
						"name": "040690",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "rename table 3504",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table GTTImportCurrent\nexec sp_rename 'GTT040690','Temp1'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['tradeFlow']"
										},
										"sink": {
											"name": "tradeFlow",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "year",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['month']"
										},
										"sink": {
											"name": "month",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['reporterCode']"
										},
										"sink": {
											"name": "reporterCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reporterName']"
										},
										"sink": {
											"name": "reporterName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerCode']"
										},
										"sink": {
											"name": "partnerCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerName']"
										},
										"sink": {
											"name": "partnerName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['hsCode']"
										},
										"sink": {
											"name": "hsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['value']"
										},
										"sink": {
											"name": "value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['unit1']"
										},
										"sink": {
											"name": "unit1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['quantity1']"
										},
										"sink": {
											"name": "quantity1",
											"type": "Double"
										}
									}
								],
								"collectionReference": "$['reportData']"
							}
						},
						"inputs": [
							{
								"referenceName": "gtt040690",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GTTImportCurrent",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Run Prep and Calcs 040690",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "040690",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[GTTImportPrep]"
						},
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "rename table 040690",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Run Prep and Calcs 040690",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "EXEC sp_rename 'Temp1','GTT040690'\n\ntruncate table GTT040690_BI\n\nInsert Into\nGTT040690_BI(date,FlowType,Year,Month,Reporter,ReporterCode,Partner,PartnerCode,Code,FourDigit,SixDigit,Item,Commodity,\nClass,Volume,Unit,Value,Currency,lb,normval,normlbs,MOMPerc,MOMActualLbs,MOMNormLbs,\nYOYPerc,YOYActualLbs,YOYNormLbs,YTDPerc,YTDActualLbs,YTDNormLbs,Avg5Year,Avg5YearVol)\n\nselect GTT040690.Date, GTT040690.FlowType, GTT040690.Year, GTT040690.Month,\nGTT040690.Declarant, GTT040690.DeclarantCde, GTT040690.Partner, GTT040690.PartnerCde, GTT040690.Code,ItemTable.FourDigit,ItemTable.SixDigit,\nGTT040690.item,CommodityTable.Commodity,ClassTable.Class, GTT040690.Volume, GTT040690.Unit, GTT040690.Value,\nGTT040690.Currency, GTT040690.LB, GTT040690.NormVal, GTT040690.Normlbs, GTT040690.MOMPerc,\nGTT040690.MOMActualLbs, GTT040690.MOMNormLbs, GTT040690.YOYPerc, GTT040690.YOYActualLbs, GTT040690.YOYNormLbs,\nGTT040690.YTDperc, GTT040690.YTDActualLbs, GTT040690.YTDNormLbs, GTT040690.Avg5Year,\nGTT040690.Avg5YearVol \n\nFrom \n\nGTT040690 inner Join ItemTable on GTT040690.Code = ItemTable.TradeCode \nInner Join CommodityTable on ItemTable.Commodity = CommodityTable.CommodityID\nInner Join ClassTable on ItemTable.Class = ClassTable.ClassID\n\n"
								}
							]
						}
					},
					{
						"name": "Run Prep and Calcs 04069",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "04069",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[GTTImportPrep]"
						},
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "rename table 04069",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Run Prep and Calcs 04069",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "EXEC sp_rename 'Temp1','GTT04069'\ntruncate table GTT04069_BI\n\nInsert Into\nGTT04069_BI(date,FlowType,Year,Month,Reporter,ReporterCode,Partner,PartnerCode,Code,FourDigit,SixDigit,Item,Commodity,\nClass,Volume,Unit,Value,Currency,lb,normval,normlbs,MOMPerc,MOMActualLbs,MOMNormLbs,\nYOYPerc,YOYActualLbs,YOYNormLbs,YTDPerc,YTDActualLbs,YTDNormLbs,Avg5Year,Avg5YearVol)\n\nselect GTT04069.Date, GTT04069.FlowType, GTT04069.Year, GTT04069.Month,\nGTT04069.Declarant, GTT04069.DeclarantCde, GTT04069.Partner, GTT04069.PartnerCde, GTT04069.Code,ItemTable.FourDigit,ItemTable.SixDigit,\nItemTable.item,CommodityTable.Commodity,ClassTable.Class, GTT04069.Volume, GTT04069.Unit, GTT04069.Value,\nGTT04069.Currency, GTT04069.LB, GTT04069.NormVal, GTT04069.Normlbs, GTT04069.MOMPerc,\nGTT04069.MOMActualLbs, GTT04069.MOMNormLbs, GTT04069.YOYPerc, GTT04069.YOYActualLbs, GTT04069.YOYNormLbs,\nGTT04069.YTDperc, GTT04069.YTDActualLbs, GTT04069.YTDNormLbs, GTT04069.Avg5Year,\nGTT04069.Avg5YearVol \n\nFrom \n\nGTT04069 Inner Join ItemTable on GTT04069.Code = ItemTable.TradeCode \nInner Join CommodityTable on ItemTable.Commodity = CommodityTable.CommodityID\nInner Join ClassTable on ItemTable.Class = ClassTable.ClassID\n"
								}
							]
						}
					},
					{
						"name": "04069",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "rename table 040690E",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table GTTImportCurrent\nexec sp_rename 'GTT04069','Temp1'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['tradeFlow']"
										},
										"sink": {
											"name": "tradeFlow",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "year",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['month']"
										},
										"sink": {
											"name": "month",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['reporterCode']"
										},
										"sink": {
											"name": "reporterCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reporterName']"
										},
										"sink": {
											"name": "reporterName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerCode']"
										},
										"sink": {
											"name": "partnerCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerName']"
										},
										"sink": {
											"name": "partnerName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['hsCode']"
										},
										"sink": {
											"name": "hsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['value']"
										},
										"sink": {
											"name": "value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['unit1']"
										},
										"sink": {
											"name": "unit1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['quantity1']"
										},
										"sink": {
											"name": "quantity1",
											"type": "Double"
										}
									}
								],
								"collectionReference": "$['reportData']"
							}
						},
						"inputs": [
							{
								"referenceName": "gtt04069",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GTTImportCurrent",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "3504",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table GTTImportCurrent\nEXEC sp_rename 'GTT3504','Temp1'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['tradeFlow']"
										},
										"sink": {
											"name": "tradeFlow",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "year",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['month']"
										},
										"sink": {
											"name": "month",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['reporterCode']"
										},
										"sink": {
											"name": "reporterCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reporterName']"
										},
										"sink": {
											"name": "reporterName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerCode']"
										},
										"sink": {
											"name": "partnerCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerName']"
										},
										"sink": {
											"name": "partnerName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['hsCode']"
										},
										"sink": {
											"name": "hsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['value']"
										},
										"sink": {
											"name": "value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['unit1']"
										},
										"sink": {
											"name": "unit1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['quantity1']"
										},
										"sink": {
											"name": "quantity1",
											"type": "Double"
										}
									}
								],
								"collectionReference": "$['reportData']"
							}
						},
						"inputs": [
							{
								"referenceName": "gtt3504",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GTTImportCurrent",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Run Prep and Calcs 3504",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "3504",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[GTTImportPrep]"
						},
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "rename table 3504",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Run Prep and Calcs 3504",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "EXEC sp_rename 'Temp1','GTT3504'\ntruncate table GTT3504_BI\n\nInsert Into\nGTT3504_BI(date,FlowType,Year,Month,Reporter,ReporterCode,Partner,PartnerCode,Code,FourDigit,SixDigit,Item,Commodity,\nClass,Volume,Unit,Value,Currency,lb,normval,normlbs,MOMPerc,MOMActualLbs,MOMNormLbs,\nYOYPerc,YOYActualLbs,YOYNormLbs,YTDPerc,YTDActualLbs,YTDNormLbs,Avg5Year,Avg5YearVol)\n\nselect GTT3504.Date, GTT3504.FlowType, GTT3504.Year, GTT3504.Month,\nGTT3504.Declarant, GTT3504.DeclarantCde, GTT3504.Partner, GTT3504.PartnerCde, GTT3504.Code,ItemTable.FourDigit,ItemTable.SixDigit,\nItemTable.item,CommodityTable.Commodity,ClassTable.Class, GTT3504.Volume, GTT3504.Unit, GTT3504.Value,\nGTT3504.Currency, GTT3504.LB, GTT3504.NormVal, GTT3504.Normlbs, GTT3504.MOMPerc,\nGTT3504.MOMActualLbs, GTT3504.MOMNormLbs, GTT3504.YOYPerc, GTT3504.YOYActualLbs, GTT3504.YOYNormLbs,\nGTT3504.YTDperc, GTT3504.YTDActualLbs, GTT3504.YTDNormLbs, GTT3504.Avg5Year,\nGTT3504.Avg5YearVol \n\nFrom \n\nGTT3504 Inner Join ItemTable on GTT3504.Code = ItemTable.TradeCode \nInner Join CommodityTable on ItemTable.Commodity = CommodityTable.CommodityID\nInner Join ClassTable on ItemTable.Class = ClassTable.ClassID\n"
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/GTT Trade')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "0404",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "rename table 04041",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table GTTImportCurrent\nexec sp_rename 'GTT0404','Temp1'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['tradeFlow']"
										},
										"sink": {
											"name": "tradeFlow",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "year",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['month']"
										},
										"sink": {
											"name": "month",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['reporterCode']"
										},
										"sink": {
											"name": "reporterCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reporterName']"
										},
										"sink": {
											"name": "reporterName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerCode']"
										},
										"sink": {
											"name": "partnerCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerName']"
										},
										"sink": {
											"name": "partnerName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['hsCode']"
										},
										"sink": {
											"name": "hsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['value']"
										},
										"sink": {
											"name": "value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['unit1']"
										},
										"sink": {
											"name": "unit1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['quantity1']"
										},
										"sink": {
											"name": "quantity1",
											"type": "Double"
										}
									}
								],
								"collectionReference": "$['reportData']"
							}
						},
						"inputs": [
							{
								"referenceName": "gtt0404",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GTTImportCurrent",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Run Prep and Calcs 0404",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "0404",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[GTTImportPrep]"
						},
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "rename table 0404",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Run Prep and Calcs 0404",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "EXEC sp_rename 'Temp1','GTT0404'\n\ntruncate table GTT0404_BI\n\nInsert Into\nGTT0404_BI(date,FlowType,Year,Month,Reporter,Partner,Code,FourDigit,SixDigit,Item,Commodity,\nClass,Volume,Unit,Value,Currency,lb,normval,normlbs,MOMPerc,MOMActualLbs,MOMNormLbs,\nYOYPerc,YOYActualLbs,YOYNormLbs,YTDPerc,YTDActualLbs,YTDNormLbs,Avg5Year,Avg5YearVol)\n\nselect GTT0404.Date, GTT0404.FlowType, GTT0404.Year, GTT0404.Month,\nGTT0404.Declarant, GTT0404.Partner, GTT0404.Code,ItemTable.FourDigit,ItemTable.SixDigit,\nGTT0404.item,CommodityTable.Commodity,ClassTable.Class, GTT0404.Volume, GTT0404.Unit, GTT0404.Value,\nGTT0404.Currency, GTT0404.LB, GTT0404.NormVal, GTT0404.Normlbs, GTT0404.MOMPerc,\nGTT0404.MOMActualLbs,MOMNormLbs, GTT0404.YOYPerc, GTT0404.YOYActualLbs, GTT0404.YOYNormLbs,\nGTT0404.YTDperc, GTT0404.YTDActualLbs, GTT0404.YTDNormLbs, GTT0404.Avg5Year,\nGTT0404.Avg5YearVol \n\nFrom \n\nGTT0404 Inner Join ItemTable on GTT0404.Code = ItemTable.TradeCode \nInner Join CommodityTable on ItemTable.Commodity = CommodityTable.CommodityID\nInner Join ClassTable on ItemTable.Class = ClassTable.ClassID\n"
								}
							]
						}
					},
					{
						"name": "0402",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "rename table 0405",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table GTTImportCurrent\nexec sp_rename 'GTT0402','Temp1'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['tradeFlow']"
										},
										"sink": {
											"name": "tradeFlow",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "year",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['month']"
										},
										"sink": {
											"name": "month",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['reporterCode']"
										},
										"sink": {
											"name": "reporterCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reporterName']"
										},
										"sink": {
											"name": "reporterName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerCode']"
										},
										"sink": {
											"name": "partnerCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerName']"
										},
										"sink": {
											"name": "partnerName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['hsCode']"
										},
										"sink": {
											"name": "hsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['value']"
										},
										"sink": {
											"name": "value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['unit1']"
										},
										"sink": {
											"name": "unit1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['quantity1']"
										},
										"sink": {
											"name": "quantity1",
											"type": "Double"
										}
									}
								],
								"collectionReference": "$['reportData']"
							}
						},
						"inputs": [
							{
								"referenceName": "gtt0402",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GTTImportCurrent",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Run Prep and Calcs 0402",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "0402",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[GTTImportPrep]"
						},
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "rename table 0402",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Run Prep and Calcs 0402",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "EXEC sp_rename 'Temp1','GTT0402'\ntruncate table GTT0402_BI\n\nInsert Into\nGTT0402_BI(date,FlowType,Year,Month,Reporter,ReporterCode,Partner,PartnerCode,Code,FourDigit,SixDigit,Item,Commodity,\nClass,Volume,Unit,Value,Currency,lb,normval,normlbs,MOMPerc,MOMActualLbs,MOMNormLbs,\nYOYPerc,YOYActualLbs,YOYNormLbs,YTDPerc,YTDActualLbs,YTDNormLbs,Avg5Year,Avg5YearVol)\n\nselect GTT0402.Date, GTT0402.FlowType, GTT0402.Year, GTT0402.Month,\nGTT0402.Declarant, GTT0402.DeclarantCde,GTT0402.Partner, GTT0402.PartnerCde, GTT0402.Code,ItemTable.FourDigit,ItemTable.SixDigit,\nItemTable.item,CommodityTable.Commodity,ClassTable.Class, GTT0402.Volume, GTT0402.Unit, GTT0402.Value,\nGTT0402.Currency, GTT0402.LB, GTT0402.NormVal, GTT0402.Normlbs, GTT0402.MOMPerc,\nGTT0402.MOMActualLbs, GTT0402.MOMNormLbs, GTT0402.YOYPerc, GTT0402.YOYActualLbs, GTT0402.YOYNormLbs,\nGTT0402.YTDperc, GTT0402.YTDActualLbs, GTT0402.YTDNormLbs, GTT0402.Avg5Year,\nGTT0402.Avg5YearVol \n\nFrom \n\nGTT0402 Inner Join ItemTable on GTT0402.Code = ItemTable.TradeCode \nInner Join CommodityTable on ItemTable.Commodity = CommodityTable.CommodityID\nInner Join ClassTable on ItemTable.Class = ClassTable.ClassID\n\n"
								}
							]
						}
					},
					{
						"name": "04041",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "rename table 0402",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table GTTImportCurrent\nexec sp_rename 'GTT04041','Temp1'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['tradeFlow']"
										},
										"sink": {
											"name": "tradeFlow",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "year",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['month']"
										},
										"sink": {
											"name": "month",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['reporterCode']"
										},
										"sink": {
											"name": "reporterCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reporterName']"
										},
										"sink": {
											"name": "reporterName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerCode']"
										},
										"sink": {
											"name": "partnerCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerName']"
										},
										"sink": {
											"name": "partnerName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['hsCode']"
										},
										"sink": {
											"name": "hsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['value']"
										},
										"sink": {
											"name": "value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['unit1']"
										},
										"sink": {
											"name": "unit1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['quantity1']"
										},
										"sink": {
											"name": "quantity1",
											"type": "Double"
										}
									}
								],
								"collectionReference": "$['reportData']"
							}
						},
						"inputs": [
							{
								"referenceName": "gtt04041",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GTTImportCurrent",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Run Prep and Calcs 04041",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "04041",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[GTTImportPrep]"
						},
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "rename table 04041",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Run Prep and Calcs 04041",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "EXEC sp_rename 'Temp1','GTT04041'\ntruncate table GTT04041_BI\n\nInsert Into\nGTT04041_BI(date,FlowType,Year,Month,Reporter,ReporterCode,Partner,PartnerCode,Code,FourDigit,SixDigit,Item,Commodity,\nClass,Volume,Unit,Value,Currency,lb,normval,normlbs,MOMPerc,MOMActualLbs,MOMNormLbs,\nYOYPerc,YOYActualLbs,YOYNormLbs,YTDPerc,YTDActualLbs,YTDNormLbs,Avg5Year,Avg5YearVol)\n\nselect GTT04041.Date, GTT04041.FlowType, GTT04041.Year, GTT04041.Month,\nGTT04041.Declarant, GTT04041.DeclarantCde, GTT04041.Partner, GTT04041.PartnerCde, GTT04041.Code,ItemTable.FourDigit,ItemTable.SixDigit,\nItemTable.item,CommodityTable.Commodity,ClassTable.Class, GTT04041.Volume, GTT04041.Unit, GTT04041.Value,\nGTT04041.Currency, GTT04041.LB, GTT04041.NormVal, GTT04041.Normlbs, GTT04041.MOMPerc,\nGTT04041.MOMActualLbs, GTT04041.MOMNormLbs, GTT04041.YOYPerc, GTT04041.YOYActualLbs, GTT04041.YOYNormLbs,\nGTT04041.YTDperc, GTT04041.YTDActualLbs, GTT04041.YTDNormLbs, GTT04041.Avg5Year,\nGTT04041.Avg5YearVol \n\nFrom \n\nGTT04041 Inner Join ItemTable on GTT04041.Code = ItemTable.TradeCode \nInner Join CommodityTable on ItemTable.Commodity = CommodityTable.CommodityID\nInner Join ClassTable on ItemTable.Class = ClassTable.ClassID\n\n"
								}
							]
						}
					},
					{
						"name": "0405",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "rename table 04051",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table GTTImportCurrent\nexec sp_rename 'GTT0405','Temp1'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['tradeFlow']"
										},
										"sink": {
											"name": "tradeFlow",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "year",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['month']"
										},
										"sink": {
											"name": "month",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['reporterCode']"
										},
										"sink": {
											"name": "reporterCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reporterName']"
										},
										"sink": {
											"name": "reporterName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerCode']"
										},
										"sink": {
											"name": "partnerCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerName']"
										},
										"sink": {
											"name": "partnerName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['hsCode']"
										},
										"sink": {
											"name": "hsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['value']"
										},
										"sink": {
											"name": "value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['unit1']"
										},
										"sink": {
											"name": "unit1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['quantity1']"
										},
										"sink": {
											"name": "quantity1",
											"type": "Double"
										}
									}
								],
								"collectionReference": "$['reportData']"
							}
						},
						"inputs": [
							{
								"referenceName": "gtt0405",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GTTImportCurrent",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Run Prep and Calcs 0405",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "0405",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[GTTImportPrep]"
						},
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "rename table 0405",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Run Prep and Calcs 0405",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "EXEC sp_rename 'Temp1','GTT0405'\ntruncate table GTT0405_BI\n\nInsert Into\nGTT0405_BI(date,FlowType,Year,Month,Reporter,ReporterCode,Partner,PartnerCode,Code,FourDigit,SixDigit,Item,Commodity,\nClass,Volume,Unit,Value,Currency,lb,normval,normlbs,MOMPerc,MOMActualLbs,MOMNormLbs,\nYOYPerc,YOYActualLbs,YOYNormLbs,YTDPerc,YTDActualLbs,YTDNormLbs,Avg5Year,Avg5YearVol)\n\nselect GTT0405.Date, GTT0405.FlowType, GTT0405.Year, GTT0405.Month,\nGTT0405.Declarant, GTT0405.DeclarantCde, GTT0405.Partner, GTT0405.PartnerCde, GTT0405.Code,ItemTable.FourDigit,ItemTable.SixDigit,\nItemTable.item,CommodityTable.Commodity,ClassTable.Class, GTT0405.Volume, GTT0405.Unit, GTT0405.Value,\nGTT0405.Currency, GTT0405.LB, GTT0405.NormVal, GTT0405.Normlbs, GTT0405.MOMPerc,\nGTT0405.MOMActualLbs, GTT0405.MOMNormLbs, GTT0405.YOYPerc, GTT0405.YOYActualLbs, GTT0405.YOYNormLbs,\nGTT0405.YTDperc, GTT0405.YTDActualLbs, GTT0405.YTDNormLbs, GTT0405.Avg5Year,\nGTT0405.Avg5YearVol \n\nFrom \n\nGTT0405 Inner Join ItemTable on GTT0405.Code = ItemTable.TradeCode \nInner Join CommodityTable on ItemTable.Commodity = CommodityTable.CommodityID\nInner Join ClassTable on ItemTable.Class = ClassTable.ClassID\n"
								}
							]
						}
					},
					{
						"name": "04051",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "rename table 0406",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table GTTImportCurrent\nexec sp_rename 'GTT04051','Temp1'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['tradeFlow']"
										},
										"sink": {
											"name": "tradeFlow",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "year",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['month']"
										},
										"sink": {
											"name": "month",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['reporterCode']"
										},
										"sink": {
											"name": "reporterCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reporterName']"
										},
										"sink": {
											"name": "reporterName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerCode']"
										},
										"sink": {
											"name": "partnerCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerName']"
										},
										"sink": {
											"name": "partnerName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['hsCode']"
										},
										"sink": {
											"name": "hsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['value']"
										},
										"sink": {
											"name": "value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['unit1']"
										},
										"sink": {
											"name": "unit1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['quantity1']"
										},
										"sink": {
											"name": "quantity1",
											"type": "Double"
										}
									}
								],
								"collectionReference": "$['reportData']"
							}
						},
						"inputs": [
							{
								"referenceName": "gtt04051",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GTTImportCurrent",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Run Prep and Calcs 04051",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "04051",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[GTTImportPrep]"
						},
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "rename table 04051",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Run Prep and Calcs 04051",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "EXEC sp_rename 'Temp1','GTT04051'\ntruncate table GTT04051_BI\n\nInsert Into\nGTT04051_BI(date,FlowType,Year,Month,Reporter,ReporterCode,Partner,PartnerCode,Code,FourDigit,SixDigit,Item,Commodity,\nClass,Volume,Unit,Value,Currency,lb,normval,normlbs,MOMPerc,MOMActualLbs,MOMNormLbs,\nYOYPerc,YOYActualLbs,YOYNormLbs,YTDPerc,YTDActualLbs,YTDNormLbs,Avg5Year,Avg5YearVol)\n\nselect GTT04051.Date, GTT04051.FlowType, GTT04051.Year, GTT04051.Month,\nGTT04051.Declarant, GTT04051.DeclarantCde, GTT04051.Partner, GTT04051.PartnerCde, GTT04051.Code,ItemTable.FourDigit,ItemTable.SixDigit,\nItemTable.item,CommodityTable.Commodity,ClassTable.Class, GTT04051.Volume, GTT04051.Unit, GTT04051.Value,\nGTT04051.Currency, GTT04051.LB, GTT04051.NormVal, GTT04051.Normlbs, GTT04051.MOMPerc,\nGTT04051.MOMActualLbs, GTT04051.MOMNormLbs, GTT04051.YOYPerc, GTT04051.YOYActualLbs, GTT04051.YOYNormLbs,\nGTT04051.YTDperc, GTT04051.YTDActualLbs, GTT04051.YTDNormLbs, GTT04051.Avg5Year,\nGTT04051.Avg5YearVol \n\nFrom \n\nGTT04051 Inner Join ItemTable on GTT04051.Code = ItemTable.TradeCode \nInner Join CommodityTable on ItemTable.Commodity = CommodityTable.CommodityID\nInner Join ClassTable on ItemTable.Class = ClassTable.ClassID\n"
								}
							]
						}
					},
					{
						"name": "0406",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "rename table 04061",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table GTTImportCurrent\nexec sp_rename 'GTT0406','Temp1'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['tradeFlow']"
										},
										"sink": {
											"name": "tradeFlow",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "year",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['month']"
										},
										"sink": {
											"name": "month",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['reporterCode']"
										},
										"sink": {
											"name": "reporterCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reporterName']"
										},
										"sink": {
											"name": "reporterName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerCode']"
										},
										"sink": {
											"name": "partnerCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerName']"
										},
										"sink": {
											"name": "partnerName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['hsCode']"
										},
										"sink": {
											"name": "hsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['value']"
										},
										"sink": {
											"name": "value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['unit1']"
										},
										"sink": {
											"name": "unit1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['quantity1']"
										},
										"sink": {
											"name": "quantity1",
											"type": "Double"
										}
									}
								],
								"collectionReference": "$['reportData']"
							}
						},
						"inputs": [
							{
								"referenceName": "GTT0406",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GTTImportCurrent",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Run Prep and Calcs 0406",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "0406",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[GTTImportPrep]"
						},
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "rename table 0406",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Run Prep and Calcs 0406",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "EXEC sp_rename 'Temp1','GTT0406'\ntruncate table GTT0406_BI\n\nInsert Into\nGTT0406_BI(date,FlowType,Year,Month,Reporter,ReporterCode,Partner,PartnerCode,Code,FourDigit,SixDigit,Item,Commodity,\nClass,Volume,Unit,Value,Currency,lb,normval,normlbs,MOMPerc,MOMActualLbs,MOMNormLbs,\nYOYPerc,YOYActualLbs,YOYNormLbs,YTDPerc,YTDActualLbs,YTDNormLbs,Avg5Year,Avg5YearVol)\n\nselect GTT0406.Date, GTT0406.FlowType, GTT0406.Year, GTT0406.Month,\nGTT0406.Declarant, GTT0406.DeclarantCde, GTT0406.Partner, GTT0406.PartnerCde, GTT0406.Code,ItemTable.FourDigit,ItemTable.SixDigit,\nItemTable.item,CommodityTable.Commodity,ClassTable.Class, GTT0406.Volume, GTT0406.Unit, GTT0406.Value,\nGTT0406.Currency, GTT0406.LB, GTT0406.NormVal, GTT0406.Normlbs, GTT0406.MOMPerc,\nGTT0406.MOMActualLbs, GTT0406.MOMNormLbs, GTT0406.YOYPerc, GTT0406.YOYActualLbs, GTT0406.YOYNormLbs,\nGTT0406.YTDperc, GTT0406.YTDActualLbs, GTT0406.YTDNormLbs, GTT0406.Avg5Year,\nGTT0406.Avg5YearVol \n\nFrom \n\nGTT0406 Inner Join ItemTable on GTT0406.Code = ItemTable.TradeCode \nInner Join CommodityTable on ItemTable.Commodity = CommodityTable.CommodityID\nInner Join ClassTable on ItemTable.Class = ClassTable.ClassID\n"
								}
							]
						}
					},
					{
						"name": "04061",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "rename table 04063",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table GTTImportCurrent\nexec sp_rename 'GTT04061','Temp1'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['tradeFlow']"
										},
										"sink": {
											"name": "tradeFlow",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "year",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['month']"
										},
										"sink": {
											"name": "month",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['reporterCode']"
										},
										"sink": {
											"name": "reporterCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reporterName']"
										},
										"sink": {
											"name": "reporterName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerCode']"
										},
										"sink": {
											"name": "partnerCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerName']"
										},
										"sink": {
											"name": "partnerName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['hsCode']"
										},
										"sink": {
											"name": "hsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['value']"
										},
										"sink": {
											"name": "value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['unit1']"
										},
										"sink": {
											"name": "unit1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['quantity1']"
										},
										"sink": {
											"name": "quantity1",
											"type": "Double"
										}
									}
								],
								"collectionReference": "$['reportData']"
							}
						},
						"inputs": [
							{
								"referenceName": "gtt04061",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GTTImportCurrent",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Run Prep and Calcs 04061",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "04061",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[GTTImportPrep]"
						},
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "rename table 04061",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Run Prep and Calcs 04061",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "EXEC sp_rename 'Temp1','GTT04061'\ntruncate table GTT04061_BI\n\nInsert Into\nGTT04061_BI(date,FlowType,Year,Month,Reporter,ReporterCode,Partner,PartnerCode,Code,FourDigit,SixDigit,Item,Commodity,\nClass,Volume,Unit,Value,Currency,lb,normval,normlbs,MOMPerc,MOMActualLbs,MOMNormLbs,\nYOYPerc,YOYActualLbs,YOYNormLbs,YTDPerc,YTDActualLbs,YTDNormLbs,Avg5Year,Avg5YearVol)\n\nselect GTT04061.Date, GTT04061.FlowType, GTT04061.Year, GTT04061.Month,\nGTT04061.Declarant, GTT04061.DeclarantCde, GTT04061.Partner, GTT04061.PartnerCde, GTT04061.Code,ItemTable.FourDigit,ItemTable.SixDigit,\nItemTable.item,CommodityTable.Commodity,ClassTable.Class, GTT04061.Volume, GTT04061.Unit, GTT04061.Value,\nGTT04061.Currency, GTT04061.LB, GTT04061.NormVal, GTT04061.Normlbs, GTT04061.MOMPerc,\nGTT04061.MOMActualLbs, GTT04061.MOMNormLbs, GTT04061.YOYPerc, GTT04061.YOYActualLbs, GTT04061.YOYNormLbs,\nGTT04061.YTDperc, GTT04061.YTDActualLbs, GTT04061.YTDNormLbs, GTT04061.Avg5Year,\nGTT04061.Avg5YearVol \n\nFrom \n\nGTT04061  Inner Join ItemTable on GTT04061.Code = ItemTable.TradeCode \nInner Join CommodityTable on ItemTable.Commodity = CommodityTable.CommodityID\nInner Join ClassTable on ItemTable.Class = ClassTable.ClassID\n"
								}
							]
						}
					},
					{
						"name": "04063",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "rename table 1702",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table GTTImportCurrent\nexec sp_rename 'GTT04063','Temp1'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['tradeFlow']"
										},
										"sink": {
											"name": "tradeFlow",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "year",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['month']"
										},
										"sink": {
											"name": "month",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['reporterCode']"
										},
										"sink": {
											"name": "reporterCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reporterName']"
										},
										"sink": {
											"name": "reporterName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerCode']"
										},
										"sink": {
											"name": "partnerCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerName']"
										},
										"sink": {
											"name": "partnerName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['hsCode']"
										},
										"sink": {
											"name": "hsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['value']"
										},
										"sink": {
											"name": "value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['unit1']"
										},
										"sink": {
											"name": "unit1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['quantity1']"
										},
										"sink": {
											"name": "quantity1",
											"type": "Double"
										}
									}
								],
								"collectionReference": "$['reportData']"
							}
						},
						"inputs": [
							{
								"referenceName": "gtt04063",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GTTImportCurrent",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Run Prep and Calcs 04063",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "04063",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[GTTImportPrep]"
						},
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "rename table 04063",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Run Prep and Calcs 04063",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "EXEC sp_rename 'Temp1','GTT04063'\ntruncate table GTT04063_BI\n\nInsert Into\nGTT04063_BI(date,FlowType,Year,Month,Reporter,ReporterCode,Partner,PartnerCode,Code,FourDigit,SixDigit,Item,Commodity,\nClass,Volume,Unit,Value,Currency,lb,normval,normlbs,MOMPerc,MOMActualLbs,MOMNormLbs,\nYOYPerc,YOYActualLbs,YOYNormLbs,YTDPerc,YTDActualLbs,YTDNormLbs,Avg5Year,Avg5YearVol)\n\nselect GTT04063.Date, GTT04063.FlowType, GTT04063.Year, GTT04063.Month,\nGTT04063.Declarant, GTT04063.DeclarantCde, GTT04063.Partner, GTT04063.PartnerCde, GTT04063.Code,ItemTable.FourDigit,ItemTable.SixDigit,\nItemTable.item,CommodityTable.Commodity,ClassTable.Class, GTT04063.Volume, GTT04063.Unit, GTT04063.Value,\nGTT04063.Currency, GTT04063.LB, GTT04063.NormVal, GTT04063.Normlbs, GTT04063.MOMPerc,\nGTT04063.MOMActualLbs, GTT04063.MOMNormLbs, GTT04063.YOYPerc, GTT04063.YOYActualLbs, GTT04063.YOYNormLbs,\nGTT04063.YTDperc, GTT04063.YTDActualLbs, GTT04063.YTDNormLbs, GTT04063.Avg5Year,\nGTT04063.Avg5YearVol \n\nFrom \n\nGTT04063 Inner Join ItemTable on GTT04063.Code = ItemTable.TradeCode \nInner Join CommodityTable on ItemTable.Commodity = CommodityTable.CommodityID\nInner Join ClassTable on ItemTable.Class = ClassTable.ClassID\n"
								}
							]
						}
					},
					{
						"name": "1702",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "rename table 3501",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table GTTImportCurrent\nexec sp_rename 'GTT1702','Temp1'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['tradeFlow']"
										},
										"sink": {
											"name": "tradeFlow",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "year",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['month']"
										},
										"sink": {
											"name": "month",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['reporterCode']"
										},
										"sink": {
											"name": "reporterCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reporterName']"
										},
										"sink": {
											"name": "reporterName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerCode']"
										},
										"sink": {
											"name": "partnerCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerName']"
										},
										"sink": {
											"name": "partnerName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['hsCode']"
										},
										"sink": {
											"name": "hsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['value']"
										},
										"sink": {
											"name": "value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['unit1']"
										},
										"sink": {
											"name": "unit1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['quantity1']"
										},
										"sink": {
											"name": "quantity1",
											"type": "Double"
										}
									}
								],
								"collectionReference": "$['reportData']"
							}
						},
						"inputs": [
							{
								"referenceName": "gtt1702",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GTTImportCurrent",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Run Prep and Calcs 1702",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "1702",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[GTTImportPrep]"
						},
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "rename table 1702",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Run Prep and Calcs 1702",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "EXEC sp_rename 'Temp1','GTT1702'\ntruncate table GTT1702_BI\n\nInsert Into\nGTT1702_BI(date,FlowType,Year,Month,Reporter,ReporterCode,Partner,PartnerCode,Code,FourDigit,SixDigit,Item,Commodity,\nClass,Volume,Unit,Value,Currency,lb,normval,normlbs,MOMPerc,MOMActualLbs,MOMNormLbs,\nYOYPerc,YOYActualLbs,YOYNormLbs,YTDPerc,YTDActualLbs,YTDNormLbs,Avg5Year,Avg5YearVol)\n\nselect GTT1702.Date, GTT1702.FlowType, GTT1702.Year, GTT1702.Month,\nGTT1702.Declarant, GTT1702.DeclarantCde, GTT1702.Partner, GTT1702.PartnerCde, GTT1702.Code,ItemTable.FourDigit,ItemTable.SixDigit,\nItemTable.item,CommodityTable.Commodity,ClassTable.Class, GTT1702.Volume, GTT1702.Unit, GTT1702.Value,\nGTT1702.Currency, GTT1702.LB, GTT1702.NormVal, GTT1702.Normlbs, GTT1702.MOMPerc,\nGTT1702.MOMActualLbs, GTT1702.MOMNormLbs, GTT1702.YOYPerc, GTT1702.YOYActualLbs, GTT1702.YOYNormLbs,\nGTT1702.YTDperc, GTT1702.YTDActualLbs, GTT1702.YTDNormLbs, GTT1702.Avg5Year,\nGTT1702.Avg5YearVol \n\nFrom \n\nGTT1702 Inner Join ItemTable on GTT1702.Code = ItemTable.TradeCode \nInner Join CommodityTable on ItemTable.Commodity = CommodityTable.CommodityID\nInner Join ClassTable on ItemTable.Class = ClassTable.ClassID\n"
								}
							]
						}
					},
					{
						"name": "3501",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table GTTImportCurrent\nexec sp_rename 'GTT3501','Temp1'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['tradeFlow']"
										},
										"sink": {
											"name": "tradeFlow",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "year",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['month']"
										},
										"sink": {
											"name": "month",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['reporterCode']"
										},
										"sink": {
											"name": "reporterCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reporterName']"
										},
										"sink": {
											"name": "reporterName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerCode']"
										},
										"sink": {
											"name": "partnerCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerName']"
										},
										"sink": {
											"name": "partnerName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['hsCode']"
										},
										"sink": {
											"name": "hsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['value']"
										},
										"sink": {
											"name": "value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['unit1']"
										},
										"sink": {
											"name": "unit1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['quantity1']"
										},
										"sink": {
											"name": "quantity1",
											"type": "Double"
										}
									}
								],
								"collectionReference": "$['reportData']"
							}
						},
						"inputs": [
							{
								"referenceName": "gtt3501",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GTTImportCurrent",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Run Prep and Calcs 3501",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "3501",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[GTTImportPrep]"
						},
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "rename table 3501",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Run Prep and Calcs 3501",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "EXEC sp_rename 'Temp1','GTT3501'\ntruncate table GTT3501_BI\n\nInsert Into\nGTT3501_BI(date,FlowType,Year,Month,Reporter,ReporterCode,Partner,PartnerCode,Code,FourDigit,SixDigit,Item,Commodity,\nClass,Volume,Unit,Value,Currency,lb,normval,normlbs,MOMPerc,MOMActualLbs,MOMNormLbs,\nYOYPerc,YOYActualLbs,YOYNormLbs,YTDPerc,YTDActualLbs,YTDNormLbs,Avg5Year,Avg5YearVol)\n\nselect GTT3501.Date, GTT3501.FlowType, GTT3501.Year, GTT3501.Month,\nGTT3501.Declarant, GTT3501.DeclarantCde, GTT3501.Partner, GTT3501.PartnerCde, GTT3501.Code,ItemTable.FourDigit,ItemTable.SixDigit,\nItemTable.item,CommodityTable.Commodity,ClassTable.Class, GTT3501.Volume, GTT3501.Unit, GTT3501.Value,\nGTT3501.Currency, GTT3501.LB, GTT3501.NormVal, GTT3501.Normlbs, GTT3501.MOMPerc,\nGTT3501.MOMActualLbs, GTT3501.MOMNormLbs, GTT3501.YOYPerc, GTT3501.YOYActualLbs, GTT3501.YOYNormLbs,\nGTT3501.YTDperc, GTT3501.YTDActualLbs, GTT3501.YTDNormLbs, GTT3501.Avg5Year,\nGTT3501.Avg5YearVol \n\nFrom \n\nGTT3501 Inner Join ItemTable on GTT3501.Code = ItemTable.TradeCode \nInner Join CommodityTable on ItemTable.Commodity = CommodityTable.CommodityID\nInner Join ClassTable on ItemTable.Class = ClassTable.ClassID\n"
								}
							]
						}
					},
					{
						"name": "3502",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "rename table 04021",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table GTTImportCurrent\nexec sp_rename 'GTT3502','Temp1'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['tradeFlow']"
										},
										"sink": {
											"name": "tradeFlow",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "year",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['month']"
										},
										"sink": {
											"name": "month",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['reporterCode']"
										},
										"sink": {
											"name": "reporterCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reporterName']"
										},
										"sink": {
											"name": "reporterName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerCode']"
										},
										"sink": {
											"name": "partnerCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerName']"
										},
										"sink": {
											"name": "partnerName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['hsCode']"
										},
										"sink": {
											"name": "hsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['value']"
										},
										"sink": {
											"name": "value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['unit1']"
										},
										"sink": {
											"name": "unit1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['quantity1']"
										},
										"sink": {
											"name": "quantity1",
											"type": "Double"
										}
									}
								],
								"collectionReference": "$['reportData']"
							}
						},
						"inputs": [
							{
								"referenceName": "GTT3502",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GTTImportCurrent",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Run Prep and Calcs 3502",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "3502",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[GTTImportPrep]"
						},
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "rename table 3502",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Run Prep and Calcs 3502",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "EXEC sp_rename 'Temp1','GTT3502'\ntruncate table GTT3502_BI\n\nInsert Into\nGTT3502_BI(date,FlowType,Year,Month,Reporter,ReporterCode,Partner,PartnerCode,Code,FourDigit,SixDigit,Item,Commodity,\nClass,Volume,Unit,Value,Currency,lb,normval,normlbs,MOMPerc,MOMActualLbs,MOMNormLbs,\nYOYPerc,YOYActualLbs,YOYNormLbs,YTDPerc,YTDActualLbs,YTDNormLbs,Avg5Year,Avg5YearVol)\n\nselect GTT3502.Date, GTT3502.FlowType, GTT3502.Year, GTT3502.Month,\nGTT3502.Declarant, GTT3502.DeclarantCde, GTT3502.Partner, GTT3502.PartnerCde, GTT3502.Code,ItemTable.FourDigit,ItemTable.SixDigit,\nItemTable.item,CommodityTable.Commodity,ClassTable.Class, GTT3502.Volume, GTT3502.Unit, GTT3502.Value,\nGTT3502.Currency, GTT3502.LB, GTT3502.NormVal, GTT3502.Normlbs, GTT3502.MOMPerc,\nGTT3502.MOMActualLbs, GTT3502.MOMNormLbs, GTT3502.YOYPerc, GTT3502.YOYActualLbs, GTT3502.YOYNormLbs,\nGTT3502.YTDperc, GTT3502.YTDActualLbs, GTT3502.YTDNormLbs, GTT3502.Avg5Year,\nGTT3502.Avg5YearVol \n\nFrom \n\nGTT3502 Inner Join ItemTable on GTT3502.Code = ItemTable.TradeCode \nInner Join CommodityTable on ItemTable.Commodity = CommodityTable.CommodityID\nInner Join ClassTable on ItemTable.Class = ClassTable.ClassID\n"
								}
							]
						}
					},
					{
						"name": "04021",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "rename table 0404",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table GTTImportCurrent\n\n",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['tradeFlow']"
										},
										"sink": {
											"name": "tradeFlow",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "year",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['month']"
										},
										"sink": {
											"name": "month",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['reporterCode']"
										},
										"sink": {
											"name": "reporterCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reporterName']"
										},
										"sink": {
											"name": "reporterName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerCode']"
										},
										"sink": {
											"name": "partnerCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerName']"
										},
										"sink": {
											"name": "partnerName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['hsCode']"
										},
										"sink": {
											"name": "hsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['value']"
										},
										"sink": {
											"name": "value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['unit1']"
										},
										"sink": {
											"name": "unit1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['quantity1']"
										},
										"sink": {
											"name": "quantity1",
											"type": "Double"
										}
									}
								],
								"collectionReference": "$['reportData']"
							}
						},
						"inputs": [
							{
								"referenceName": "gtt04021",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GTTImportCurrent",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Run Prep and Calcs 04021",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "04021",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[GTTImportPrep]"
						},
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "rename table 04021",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Run Prep and Calcs 04021",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "EXEC sp_rename 'Temp1','GTT04021'\ntruncate table GTT04021_BI\n\nInsert Into\nGTT04021_BI(date,FlowType,Year,Month,Reporter,ReporterCode,Partner,PartnerCode,Code,FourDigit,SixDigit,Item,Commodity,\nClass,Volume,Unit,Value,Currency,lb,normval,normlbs,MOMPerc,MOMActualLbs,MOMNormLbs,\nYOYPerc,YOYActualLbs,YOYNormLbs,YTDPerc,YTDActualLbs,YTDNormLbs,Avg5Year,Avg5YearVol)\n\nselect GTT04021.Date, GTT04021.FlowType, GTT04021.Year, GTT04021.Month,\nGTT04021.Declarant, GTT04021.DeclarantCde, GTT04021.Partner, GTT04021.PartnerCde, GTT04021.Code,ItemTable.FourDigit,ItemTable.SixDigit,\nItemTable.item,CommodityTable.Commodity,ClassTable.Class, GTT04021.Volume, GTT04021.Unit, GTT04021.Value,\nGTT04021.Currency, GTT04021.LB, GTT04021.NormVal, GTT04021.Normlbs, GTT04021.MOMPerc,\nGTT04021.MOMActualLbs, GTT04021.MOMNormLbs, GTT04021.YOYPerc, GTT04021.YOYActualLbs, GTT04021.YOYNormLbs,\nGTT04021.YTDperc, GTT04021.YTDActualLbs, GTT04021.YTDNormLbs, GTT04021.Avg5Year,\nGTT04021.Avg5YearVol \n\nFrom \n\nGTT04021 Inner Join ItemTable on GTT04021.Code = ItemTable.TradeCode \nInner Join CommodityTable on ItemTable.Commodity = CommodityTable.CommodityID\nInner Join ClassTable on ItemTable.Class = ClassTable.ClassID\n"
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/GTT World Pull')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "GTTWorld5",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table GTTImportCurrent\nexec sp_rename 'GTTWorld5','Temp1'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['tradeFlow']"
										},
										"sink": {
											"name": "tradeFlow",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "year",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['month']"
										},
										"sink": {
											"name": "month",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['reporterCode']"
										},
										"sink": {
											"name": "reporterCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reporterName']"
										},
										"sink": {
											"name": "reporterName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerCode']"
										},
										"sink": {
											"name": "partnerCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerName']"
										},
										"sink": {
											"name": "partnerName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['hsCode']"
										},
										"sink": {
											"name": "hsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['value']"
										},
										"sink": {
											"name": "value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['unit1']"
										},
										"sink": {
											"name": "unit1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['quantity1']"
										},
										"sink": {
											"name": "quantity1",
											"type": "Double"
										}
									}
								],
								"collectionReference": "$['reportData']"
							}
						},
						"inputs": [
							{
								"referenceName": "GTTWorld5",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GTTImportCurrent",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Run Prep and Calcs GTTWorld5",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "GTTWorld5",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[GTTImportPrep]"
						},
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "rename table GTTWorld5",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Run Prep and Calcs GTTWorld5",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "EXEC sp_rename 'Temp1','GTTWorld5'\ntruncate table GTTWorld_BI\n\nInsert Into\nGTTWorld_BI(date,FlowType,Year,Month,Reporter,ReporterCode,Partner,PartnerCode,Code,FourDigit,SixDigit,Item,Commodity,\nClass,Volume,Unit,Value,Currency,lb,normval,normlbs,MOMPerc,MOMActualLbs,MOMNormLbs,\nYOYPerc,YOYActualLbs,YOYNormLbs,YTDPerc,YTDActualLbs,YTDNormLbs,Avg5Year,Avg5YearVol)\n\nSelect  GTTWorld5.Date, Insert Into\nGTTWorld_BI(date,FlowType,Year,Month,Reporter,ReporterCode,Partner,PartnerCode,Code,FourDigit,SixDigit,Item,Commodity,\nClass,Volume,Unit,Value,Currency,lb,normval,normlbs,MOMPerc,MOMActualLbs,MOMNormLbs,\nYOYPerc,YOYActualLbs,YOYNormLbs,YTDPerc,YTDActualLbs,YTDNormLbs,Avg5Year,Avg5YearVol)\n\nSelect  GTTWorld5.Date, GTTWorld5.FlowType, GTTWorld5.Year, GTTWorld5.Month,\nGTTWorld5.Declarant, GTTWorld5.DeclarantCde, GTTWorld5.Partner, GTTWorld5.PartnerCde, GTTWorld5.Code,ItemTable.FourDigit,ItemTable.SixDigit,\nItemTable.item,CommodityTable.Commodity,ClassTable.Class, GTTWorld5.Volume, GTTWorld5.Unit, GTTWorld5.Value,\nGTTWorld5.Currency, GTTWorld5.LB, GTTWorld5.NormVal, GTTWorld5.Normlbs, GTTWorld5.MOMPerc,\nGTTWorld5.MOMActualLbs, GTTWorld5.MOMNormLbs, GTTWorld5.YOYPerc, GTTWorld5.YOYActualLbs, GTTWorld5.YOYNormLbs,\nGTTWorld5.YTDperc, GTTWorld5.YTDActualLbs, GTTWorld5.YTDNormLbs, GTTWorld5.Avg5Year,\nGTTWorld5.Avg5YearVol \n\nFrom \n\nGTTWorld5 Inner Join ItemTable on GTTWorld5.Code = ItemTable.TradeCode \nInner Join CommodityTable on ItemTable.Commodity = CommodityTable.CommodityID\nInner Join ClassTable on ItemTable.Class = ClassTable.ClassID\n\n"
								}
							]
						}
					},
					{
						"name": "GTTWorld4",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "rename table GTTWorld5",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table GTTImportCurrent\nexec sp_rename 'GTTWorld4','Temp1'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['tradeFlow']"
										},
										"sink": {
											"name": "tradeFlow",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "year",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['month']"
										},
										"sink": {
											"name": "month",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['reporterCode']"
										},
										"sink": {
											"name": "reporterCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reporterName']"
										},
										"sink": {
											"name": "reporterName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerCode']"
										},
										"sink": {
											"name": "partnerCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerName']"
										},
										"sink": {
											"name": "partnerName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['hsCode']"
										},
										"sink": {
											"name": "hsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['value']"
										},
										"sink": {
											"name": "value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['unit1']"
										},
										"sink": {
											"name": "unit1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['quantity1']"
										},
										"sink": {
											"name": "quantity1",
											"type": "Double"
										}
									}
								],
								"collectionReference": "$['reportData']"
							}
						},
						"inputs": [
							{
								"referenceName": "GTTWorld4",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GTTImportCurrent",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Run Prep and Calcs GTTWorld4",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "GTTWorld4",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[GTTImportPrep]"
						},
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "rename table GTTWorld4",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Run Prep and Calcs GTTWorld4",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "EXEC sp_rename 'Temp1','GTTWorld4'\n\n\nInsert Into\nGTTWorld_BI(date,FlowType,Year,Month,Reporter,ReporterCode,Partner,PartnerCode,Code,FourDigit,SixDigit,Item,Commodity,\nClass,Volume,Unit,Value,Currency,lb,normval,normlbs,MOMPerc,MOMActualLbs,MOMNormLbs,\nYOYPerc,YOYActualLbs,YOYNormLbs,YTDPerc,YTDActualLbs,YTDNormLbs,Avg5Year,Avg5YearVol) \n\nSelect  GTTWorld4.Date, GTTWorld4.FlowType, GTTWorld4.Year, GTTWorld4.Month,\nGTTWorld4.Declarant, GTTWorld4.DeclarantCde, GTTWorld4.Partner, GTTWorld4.PartnerCde, GTTWorld4.Code,ItemTable.FourDigit,ItemTable.SixDigit,\nItemTable.item,CommodityTable.Commodity,ClassTable.Class, GTTWorld4.Volume, GTTWorld4.Unit, GTTWorld4.Value,\nGTTWorld4.Currency, GTTWorld4.LB, GTTWorld4.NormVal, GTTWorld4.Normlbs, GTTWorld4.MOMPerc,\nGTTWorld4.MOMActualLbs, GTTWorld4.MOMNormLbs, GTTWorld4.YOYPerc, GTTWorld4.YOYActualLbs, GTTWorld4.YOYNormLbs,\nGTTWorld4.YTDperc, GTTWorld4.YTDActualLbs, GTTWorld4.YTDNormLbs, GTTWorld4.Avg5Year,\nGTTWorld4.Avg5YearVol \n\nFrom \n\nGTTWorld4 Inner Join ItemTable on GTTWorld4.Code = ItemTable.TradeCode \nInner Join CommodityTable on ItemTable.Commodity = CommodityTable.CommodityID\nInner Join ClassTable on ItemTable.Class = ClassTable.ClassID\n"
								}
							]
						}
					},
					{
						"name": "GTTWorld3",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "rename table GTTWorld4",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table GTTImportCurrent\nexec sp_rename 'GTTWorld3','Temp1'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['tradeFlow']"
										},
										"sink": {
											"name": "tradeFlow",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "year",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['month']"
										},
										"sink": {
											"name": "month",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['reporterCode']"
										},
										"sink": {
											"name": "reporterCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reporterName']"
										},
										"sink": {
											"name": "reporterName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerCode']"
										},
										"sink": {
											"name": "partnerCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerName']"
										},
										"sink": {
											"name": "partnerName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['hsCode']"
										},
										"sink": {
											"name": "hsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['value']"
										},
										"sink": {
											"name": "value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['unit1']"
										},
										"sink": {
											"name": "unit1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['quantity1']"
										},
										"sink": {
											"name": "quantity1",
											"type": "Double"
										}
									}
								],
								"collectionReference": "$['reportData']"
							}
						},
						"inputs": [
							{
								"referenceName": "GTTWorld3",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GTTImportCurrent",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Run Prep and Calcs GTTWorld3",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "GTTWorld3",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[GTTImportPrep]"
						},
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "rename table GTTWorld3",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Run Prep and Calcs GTTWorld3",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "EXEC sp_rename 'Temp1','GTTWorld3'\n\n\nSelect  GTTWorld3.Date, GTTWorld3.FlowType, GTTWorld3.Year, GTTWorld3.Month,\nGTTWorld3.Declarant, GTTWorld3.DeclarantCde, GTTWorld3.Partner, GTTWorld3.PartnerCde, GTTWorld3.Code,ItemTable.FourDigit,ItemTable.SixDigit,\nItemTable.item,CommodityTable.Commodity,ClassTable.Class, GTTWorld3.Volume, GTTWorld3.Unit, GTTWorld3.Value,\nGTTWorld3.Currency, GTTWorld3.LB, GTTWorld3.NormVal, GTTWorld3.Normlbs, GTTWorld3.MOMPerc,\nGTTWorld3.MOMActualLbs, GTTWorld3.MOMNormLbs, GTTWorld3.YOYPerc, GTTWorld3.YOYActualLbs, GTTWorld3.YOYNormLbs,\nGTTWorld3.YTDperc, GTTWorld3.YTDActualLbs, GTTWorld3.YTDNormLbs, GTTWorld3.Avg5Year,\nGTTWorld3.Avg5YearVol \n\nFrom \n\nGTTWorld3 Inner Join ItemTable on GTTWorld3.Code = ItemTable.TradeCode \nInner Join CommodityTable on ItemTable.Commodity = CommodityTable.CommodityID\nInner Join ClassTable on ItemTable.Class = ClassTable.ClassID\n\n"
								}
							]
						}
					},
					{
						"name": "GTTWorld1",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "rename table GTTWorld3",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:03:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET",
								"paginationRules": {
									"supportRFC5988": "true"
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table GTTImportCurrent\nexec sp_rename 'GTTWorld1','Temp1'",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['tradeFlow']"
										},
										"sink": {
											"name": "tradeFlow",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "year",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['month']"
										},
										"sink": {
											"name": "month",
											"type": "Int64"
										}
									},
									{
										"source": {
											"path": "[['reporterCode']"
										},
										"sink": {
											"name": "reporterCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reporterName']"
										},
										"sink": {
											"name": "reporterName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerCode']"
										},
										"sink": {
											"name": "partnerCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['partnerName']"
										},
										"sink": {
											"name": "partnerName",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['hsCode']"
										},
										"sink": {
											"name": "hsCode",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['currency']"
										},
										"sink": {
											"name": "currency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['value']"
										},
										"sink": {
											"name": "value",
											"type": "Double"
										}
									},
									{
										"source": {
											"path": "[['unit1']"
										},
										"sink": {
											"name": "unit1",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['quantity1']"
										},
										"sink": {
											"name": "quantity1",
											"type": "Double"
										}
									}
								],
								"collectionReference": "$['reportData']"
							}
						},
						"inputs": [
							{
								"referenceName": "GTTWorld1",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GTTImportCurrent",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Run Prep and Calcs GTTWorld1",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "GTTWorld1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[GTTImportPrep]"
						},
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "rename table GTTWorld1",
						"type": "Script",
						"dependsOn": [
							{
								"activity": "Run Prep and Calcs GTTWorld1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"linkedServiceName": {
							"referenceName": "tradeDB",
							"type": "LinkedServiceReference"
						},
						"typeProperties": {
							"scripts": [
								{
									"type": "Query",
									"text": "EXEC sp_rename 'Temp1','GTTWorld1'\n\n\nSelect  GTTWorld1.Date, GTTWorld1.FlowType, GTTWorld1.Year, GTTWorld1.Month,\nGTTWorld1.Declarant, GTTWorld1.DeclarantCde, GTTWorld1.Partner, GTTWorld1.PartnerCde, GTTWorld1.Code,ItemTable.FourDigit,ItemTable.SixDigit,\nItemTable.item,CommodityTable.Commodity,ClassTable.Class, GTTWorld1.Volume, GTTWorld1.Unit, GTTWorld1.Value,\nGTTWorld1.Currency, GTTWorld1.LB, GTTWorld1.NormVal, GTTWorld1.Normlbs, GTTWorld1.MOMPerc,\nGTTWorld1.MOMActualLbs, GTTWorld1.MOMNormLbs, GTTWorld1.YOYPerc, GTTWorld1.YOYActualLbs, GTTWorld1.YOYNormLbs,\nGTTWorld1.YTDperc, GTTWorld1.YTDActualLbs, GTTWorld1.YTDNormLbs, GTTWorld1.Avg5Year,\nGTTWorld1.Avg5YearVol \n\nFrom \n\nGTTWorld1 Inner Join ItemTable on GTTWorld1.Code = ItemTable.TradeCode \nInner Join CommodityTable on ItemTable.Commodity = CommodityTable.CommodityID\nInner Join ClassTable on ItemTable.Class = ClassTable.ClassID\n"
								}
							]
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/GatsAPI')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Copy data1",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET"
							},
							"sink": {
								"type": "SqlServerSink",
								"tableOption": "autoCreate"
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "GatsAPI",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GatsData",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Global  UK Pipeline')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "UK Dairy Prod",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table globl.UKDairyImport",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Date",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "DateString",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Milk available to Processors (Million liters)",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Milk",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Liquid Milk Production (million liters)",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "DrinkingMilk",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Cheese Production ('000 tonnes)",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Cheese",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Butter Production ('000 tonnes)",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Butter",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Milk Powder Production ('000 tonnes)",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "SMP",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "UKDairyProd",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "UKGlobalImport",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "UK Slaughter Import",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "UK Dairy Prod",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table globl.UKSlaughterImport",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Column1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "DateString",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Heifers",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "HeifferSlaughter",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Cows",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CowSlaughter",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "UKSlaughter",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "GlobalUKSlaughter",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "GlobalUKPrep",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "UK Slaughter Import",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[GLOBL].[GlobaLUKPrep]"
						},
						"linkedServiceName": {
							"referenceName": "Sara Database",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "global clacs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "GlobalUKPrep",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[GLOBL].[GlobalCalcs]"
						},
						"linkedServiceName": {
							"referenceName": "Sara Database",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Global BI Transfer",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "global clacs",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[GLOBL].[GlobalBITransfer]",
							"storedProcedureParameters": {
								"Zone": {
									"value": "UK",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Sara Database",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Global AUS Milk')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "AUS MILK Data",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": false,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table globl.AusGlobalMilk",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Period",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "DateString",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "AUSTRALIA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ValueString",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "AUSMilk",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "AusGlobalMilk",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "AUS PROTEIN",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "AUS MILK Data",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "update globl.AUSGlobalMilk \nset itemid = 13 where itemid is null",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Column2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "DateString",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "AUSTRALIA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ValueString",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "AusProtein",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "AusGlobalMilk",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "AUS FAT",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "AUS PROTEIN",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "update globl.AUSGlobalMilk\nset itemid = 2 where itemid is null",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Column2",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "DateString",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "AUSTRALIA",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ValueString",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "AusFat",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "AusGlobalMilk",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "AUS Milk Prep",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "AUS FAT",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[GLOBL].[GlobaLAUMilkPrep]"
						},
						"linkedServiceName": {
							"referenceName": "Sara Database",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Data Calcs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "AUS Milk Prep",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[GLOBL].[GlobalCalcs]"
						},
						"linkedServiceName": {
							"referenceName": "Sara Database",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "BI Transfer",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Data Calcs",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[GLOBL].[GlobalBITransfer]",
							"storedProcedureParameters": {
								"Zone": {
									"value": "AUMILK",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Sara Database",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Global Euro Pipeline')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "EU Global Dairy",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table Globl.EUGlobalImp",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "geo",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CountryID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TIME_PERIOD",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "DateString",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "dairyprod",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "GlobalID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "unit",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OBS_VALUE",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ValueString",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EUDairy",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EUGobalImport",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "EU Global Slaughter",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "EU Global Dairy",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "geo",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CountryID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TIME_PERIOD",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "DateString",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "meat",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "GlobalID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OBS_VALUE",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ValueString",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EUSlaughter",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EUGobalImport",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "EU Global Cow Heard",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "EU Global Slaughter",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "geo",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "CountryID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "TIME_PERIOD",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "YearString",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "animals",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "GlobalID",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "OBS_VALUE",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ValueString",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EUCowsNum",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "EUGobalImport",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "EU Global Data Setup",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "EU Global Cow Heard",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[GLOBL].[GlobaLEUPrep]"
						},
						"linkedServiceName": {
							"referenceName": "Sara Database",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "EU Global Calcs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "EU Global Data Setup",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[GLOBL].[GlobalCalcs]"
						},
						"linkedServiceName": {
							"referenceName": "Sara Database",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "BI Transfer",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "EU Global Calcs",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[GLOBL].[GlobalBITransfer]",
							"storedProcedureParameters": {
								"Zone": {
									"value": "EURO",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Sara Database",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Global NZ Pipeline')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "NZ Slaughter Import",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table globl.nzglobalimp\ntruncate table globl.globalimp",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"type": "String",
											"ordinal": 1
										},
										"sink": {
											"name": "Date",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"ordinal": 2
										},
										"sink": {
											"name": "Heiffers",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"ordinal": 3
										},
										"sink": {
											"name": "Cows",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "NZSlaughter",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "NzSlaughterImport",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "NZ Heard Import",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "NZ Slaughter Import",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table globl.nzheardimp",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": true,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"type": "String",
											"ordinal": 1
										},
										"sink": {
											"name": "Year",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"ordinal": 2
										},
										"sink": {
											"name": "NotInMilk",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"ordinal": 3
										},
										"sink": {
											"name": "InMilk",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"type": "String",
											"ordinal": 4
										},
										"sink": {
											"name": "Total",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "NZHeard",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "NZHeardImport",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "NZ Milk",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "NZ Heard Import",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "drop table globl.nzmilkimp\n\n",
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": true,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "NZDairyImport",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "NZDairyImp",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "NZ Milk Solids",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "NZ Milk Prep",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "drop table globl.nzmilkimp\n\n",
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "NZMilkSolids",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "NZDairyImp",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "NZ Milk Prep",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "NZ Milk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[GLOBL].[NZMilkPrep]",
							"storedProcedureParameters": {
								"Item": {
									"value": "13",
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Sara Database",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "NZ MILK Solids Prep",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "NZ Milk Solids",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[GLOBL].[NZMilkPrep]",
							"storedProcedureParameters": {
								"Item": {
									"value": "23",
									"type": "Int32"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Sara Database",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "NZ Prep",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "NZ MILK Solids Prep",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[GLOBL].[GlobalNZPrep]"
						},
						"linkedServiceName": {
							"referenceName": "Sara Database",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "global clacs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "NZ Prep",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[GLOBL].[GlobalCalcs]"
						},
						"linkedServiceName": {
							"referenceName": "Sara Database",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Global BI Transfer",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "global clacs",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[GLOBL].[GlobalBITransfer]",
							"storedProcedureParameters": {
								"Zone": {
									"value": "NZ",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Sara Database",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Ice Cream Pipeline')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "ID Updates",
						"description": "Set the proper ids in USDADATA table",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "IceCreamInsert",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[USDA].[UpdateIds]"
						},
						"linkedServiceName": {
							"referenceName": "SaraDB connection",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Work Table Transfer",
						"description": "Transfer data to workDairy table",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "ID Updates",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlServerSink",
								"preCopyScript": "exec USDA.WorkDairySave\ntruncate table USDA.WorkDairyProd",
								"writeBehavior": "insert"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "GRPID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "GRPID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "CommodityID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "CommodityID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Class",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Class",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CatID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "CatID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "UnitID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "UnitID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Domain",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Domain",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "StateAnsi",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "StateAnsi",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "GeoID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "GeoID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Region",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Region",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "State",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "State",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WeekEnding",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "WeekEnding",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Period",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Period",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PeriodID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PeriodID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "FreqID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PeriodTypeID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "NormValue",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										},
										"sink": {
											"name": "NormValue",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 18
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 18
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "USDAData",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "WorkDairyProd",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Dairy Transformations",
						"description": "Executes 4 procedures to deal with all dairy calculations and queries",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Work Table Transfer",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[USDA].[DairyProcedureIceCream]"
						},
						"linkedServiceName": {
							"referenceName": "SaraDB connection",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "BackUps",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Dairy Transformations",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[USDA].[RobinBackUps]"
						},
						"linkedServiceName": {
							"referenceName": "SaraDB connection",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Count",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "BackUps",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[USDA].[TriggerRuns]",
							"storedProcedureParameters": {
								"Trigger": {
									"value": "DailyPipeline",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "SaraDB connection",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "IceCreamBlob",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "SqlServerSink",
								"preCopyScript": "truncate table usda.usdadatafactory"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Commodity",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Commodity",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Class",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Class",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Domain",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Domain",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Data Item",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "State ANSI",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "StateAnsi",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Region",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Region",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "State",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "State",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Period",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Period",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Value",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Value",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Year",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "IceCream",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "USDADataFactory",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy to USDAData",
						"description": "transfer from DataFactory to USDAData",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "IceCreamBlob",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlServerSink",
								"preCopyScript": "update usda.usdadatafactory set weekending = cast(weekendingstring as date)\n\twhere weekending <> ''\n\tupdate usda.usdadatafactory set value = replace(value,',','')\n\tupdate USDA.USDADataFactory set value = NULL where isnumeric(value) = 0\n\tupdate usda.usdadatafactory set valuedec = cast(value as decimal(18,0))\n\tupdate usda.usdadatafactory set stateansiint = cast(stateansi as int)\n\ntruncate table usda.usdadata\n\n\n\n\n",
								"writeBehavior": "insert"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "GRP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "GRP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Commodity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Commodity",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Class",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Class",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Category",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Category",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Unit",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Domain",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Domain",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "StateAnsiInt",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "StateAnsi",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Region",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Region",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "State",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "State",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Frequency",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Frequency",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Period",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Period",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ValueDec",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 18
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "USDADataFactory",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "USDAData",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "IceCreamInsert",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy to USDAData",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[USDA].[IceCreamInsert]"
						},
						"linkedServiceName": {
							"referenceName": "Sara Database",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "BI Transfer",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Count",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[USDA].[USDA_BI_Transfer]"
						},
						"linkedServiceName": {
							"referenceName": "Sara Database",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Mexico Milk Pipeline')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Mexico Milk",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table globl.LatinAmGlobal",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Month",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "DateString",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Volume",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ValueString",
											"type": "String",
											"physicalType": "varchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MexicoMilk",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "LatinAmGlobal",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Latin America Prep",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Mexico Milk",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[GLOBL].[GlobalLatPrep]",
							"storedProcedureParameters": {
								"Country": {
									"value": "MX",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Sara Database",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Calcs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Latin America Prep",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[GLOBL].[GlobalCalcs]"
						},
						"linkedServiceName": {
							"referenceName": "Sara Database",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "BI Transfer",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Calcs",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[GLOBL].[GlobalBITransfer]",
							"storedProcedureParameters": {
								"Zone": {
									"value": "MX",
									"type": "String"
								}
							}
						},
						"linkedServiceName": {
							"referenceName": "Sara Database",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/MilkProductionCowInventory')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Milk Prod , Cow Inv, Pord Per Cow\n",
				"activities": [
					{
						"name": "Milk Production API",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CopyMilkAnnualProduction",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET"
							},
							"sink": {
								"type": "SqlServerSink",
								"preCopyScript": "delete from usda.usdadatafactory where Year > 2015 "
							},
							"enableStaging": false,
							"enableSkipIncompatibleRow": true,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['region_desc']"
										},
										"sink": {
											"name": "Region",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['statisticcat_desc']"
										},
										"sink": {
											"name": "Category",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Value']"
										},
										"sink": {
											"name": "Value",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['short_desc']"
										},
										"sink": {
											"name": "ItemConcat",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['domain_desc']"
										},
										"sink": {
											"name": "Domain",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['prodn_practice_desc']"
										},
										"sink": {
											"name": "ProdPract",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['domaincat_desc']"
										},
										"sink": {
											"name": "DomainCat",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['class_desc']"
										},
										"sink": {
											"name": "Class",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reference_period_desc']"
										},
										"sink": {
											"name": "Period",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "Year",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['state_name']"
										},
										"sink": {
											"name": "State",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['group_desc']"
										},
										"sink": {
											"name": "GRP",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['commodity_desc']"
										},
										"sink": {
											"name": "Commodity",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['freq_desc']"
										},
										"sink": {
											"name": "Frequency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['unit_desc']"
										},
										"sink": {
											"name": "Unit",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['state_ansi']"
										},
										"sink": {
											"name": "StateAnsi",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['util_practice_desc']"
										},
										"sink": {
											"name": "UtilPract",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['data']"
							}
						},
						"inputs": [
							{
								"referenceName": "MilkProductionAPI",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DataFactoryTable",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "CopyMilkAnnualProduction",
						"description": "Last 10 years of milk prod",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET"
							},
							"sink": {
								"type": "SqlServerSink",
								"preCopyScript": "truncate table USDA.USDADataFactory"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['week_ending']"
										},
										"sink": {
											"name": "WeekEndingString",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['domaincat_desc']"
										},
										"sink": {
											"name": "DomainCat",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Value']"
										},
										"sink": {
											"name": "Value",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['short_desc']"
										},
										"sink": {
											"name": "ItemConcat",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['statisticcat_desc']"
										},
										"sink": {
											"name": "Category",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['freq_desc']"
										},
										"sink": {
											"name": "Frequency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['state_name']"
										},
										"sink": {
											"name": "State",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['class_desc']"
										},
										"sink": {
											"name": "Class",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reference_period_desc']"
										},
										"sink": {
											"name": "Period",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['region_desc']"
										},
										"sink": {
											"name": "Region",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "Year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['unit_desc']"
										},
										"sink": {
											"name": "Unit",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['state_ansi']"
										},
										"sink": {
											"name": "StateAnsi",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['prodn_practice_desc']"
										},
										"sink": {
											"name": "ProdPract",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['util_practice_desc']"
										},
										"sink": {
											"name": "UtilPract",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['group_desc']"
										},
										"sink": {
											"name": "GRP",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['commodity_desc']"
										},
										"sink": {
											"name": "Commodity",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['domain_desc']"
										},
										"sink": {
											"name": "Domain",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['data']"
							}
						},
						"inputs": [
							{
								"referenceName": "MilkAnnualAPI",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DataFactoryTable",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "ID Updates",
						"description": "Set the proper ids in USDADATA table",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy to USDAData",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[USDA].[UpdateIds]"
						},
						"linkedServiceName": {
							"referenceName": "SaraDB connection",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Copy to USDAData",
						"description": "transfer from DataFactory to USDAData",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Milk Production API",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlServerSink",
								"preCopyScript": "update usda.usdadatafactory set weekending = cast(weekendingstring as date)\n\twhere weekending <> ''\n\tupdate usda.usdadatafactory set value = replace(value,',','')\n\tupdate USDA.USDADataFactory set value = NULL where isnumeric(value) = 0\n\tupdate usda.usdadatafactory set valuedec = cast(value as decimal(18,0))\n\tupdate usda.usdadatafactory set stateansiint = cast(stateansi as int)\n\n\n\ttruncate table USDA.USDAData\n"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "GRP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "GRP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Commodity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Commodity",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Class",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Class",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Category",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Category",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Unit",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Domain",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Domain",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "StateAnsiInt",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "StateAnsi",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Region",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Region",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "State",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "State",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Frequency",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Frequency",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Period",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Period",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ValueDec",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 18
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "USDADataFactory",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "USDAData",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "ToWorkDairyMilkProd",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "ID Updates",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlServerSink",
								"preCopyScript": "truncate table usda.workDairyMilkProd"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "GRPID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "GRPID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "CommodityID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "CommodityID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "Class",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Class",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "CatID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "CatID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "UnitID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "UnitID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Domain",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Domain",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "StateAnsi",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "StateAnsi",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "GeoID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "GeoID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Region",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Region",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "State",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "State",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "WeekEnding",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "WeekEnding",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "FreqID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PeriodTypeID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Period",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Period",
											"type": "String",
											"physicalType": "varchar"
										}
									},
									{
										"source": {
											"name": "PeriodID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PeriodID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 18
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "NormValue",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										},
										"sink": {
											"name": "NormValue",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "USDAData",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "WorkDairyMilkProd",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Just Milk Procedure",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "ToWorkDairyMilkProd",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[USDA].[JustMilkProd]"
						},
						"linkedServiceName": {
							"referenceName": "SaraDB connection",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Import Num Cows",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Milk Per Cow",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET"
							},
							"sink": {
								"type": "SqlServerSink",
								"preCopyScript": "delete from usda.usdadatafactory where unit <> 'LB / HEAD'"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['prodn_practice_desc']"
										},
										"sink": {
											"name": "ProdPract",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['domaincat_desc']"
										},
										"sink": {
											"name": "DomainCat",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reference_period_desc']"
										},
										"sink": {
											"name": "Period",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['class_desc']"
										},
										"sink": {
											"name": "Class",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['commodity_desc']"
										},
										"sink": {
											"name": "Commodity",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['state_name']"
										},
										"sink": {
											"name": "State",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['domain_desc']"
										},
										"sink": {
											"name": "Domain",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['short_desc']"
										},
										"sink": {
											"name": "ItemConcat",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['unit_desc']"
										},
										"sink": {
											"name": "Unit",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "Year",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['region_desc']"
										},
										"sink": {
											"name": "Region",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['freq_desc']"
										},
										"sink": {
											"name": "Frequency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Value']"
										},
										"sink": {
											"name": "Value",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['util_practice_desc']"
										},
										"sink": {
											"name": "UtilPract",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['state_ansi']"
										},
										"sink": {
											"name": "StateAnsi",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['statisticcat_desc']"
										},
										"sink": {
											"name": "Category",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['group_desc']"
										},
										"sink": {
											"name": "GRP",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['data']"
							}
						},
						"inputs": [
							{
								"referenceName": "NumCowsAPI",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DataFactoryTable",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Milk Per Cow",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Just Milk Procedure",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET"
							},
							"sink": {
								"type": "SqlServerSink",
								"preCopyScript": "truncate table usda.usdadatafactory"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['commodity_desc']"
										},
										"sink": {
											"name": "Commodity",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['class_desc']"
										},
										"sink": {
											"name": "Class",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['domaincat_desc']"
										},
										"sink": {
											"name": "DomainCat",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reference_period_desc']"
										},
										"sink": {
											"name": "Period",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['prodn_practice_desc']"
										},
										"sink": {
											"name": "ProdPract",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['group_desc']"
										},
										"sink": {
											"name": "GRP",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['statisticcat_desc']"
										},
										"sink": {
											"name": "Category",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['freq_desc']"
										},
										"sink": {
											"name": "Frequency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Value']"
										},
										"sink": {
											"name": "Value",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['state_ansi']"
										},
										"sink": {
											"name": "StateAnsi",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['util_practice_desc']"
										},
										"sink": {
											"name": "UtilPract",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "Year",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['region_desc']"
										},
										"sink": {
											"name": "Region",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['domain_desc']"
										},
										"sink": {
											"name": "Domain",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['state_name']"
										},
										"sink": {
											"name": "State",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['unit_desc']"
										},
										"sink": {
											"name": "Unit",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['short_desc']"
										},
										"sink": {
											"name": "ItemConcat",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['data']"
							}
						},
						"inputs": [
							{
								"referenceName": "MilkPerCowAPI",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DataFactoryTable",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy to USDAData_copy1",
						"description": "transfer from DataFactory to USDAData",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Import Num Cows",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlServerSink",
								"preCopyScript": "\nupdate usda.usdadatafactory set weekending = cast(weekendingstring as date)\n\twhere weekending <> ''\n\tupdate usda.usdadatafactory set value = replace(value,',','')\n\tupdate USDA.USDADataFactory set value = NULL where isnumeric(value) = 0\n\tupdate usda.usdadatafactory set valuedec = cast(value as decimal(18,0))\n\tupdate usda.usdadatafactory set stateansiint = cast(stateansi as int)\n\n\n\ttruncate table USDA.USDAData\n"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "GRP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "GRP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Commodity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Commodity",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Class",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Class",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Category",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Category",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Unit",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Domain",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Domain",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "StateAnsiInt",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "StateAnsi",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Region",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Region",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "State",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "State",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Frequency",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Frequency",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Period",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Period",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ValueDec",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 18
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "USDADataFactory",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "USDAData",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "ID Updates_copy1",
						"description": "Set the proper ids in USDADATA table",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy to USDAData_copy1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[USDA].[UpdateIds]"
						},
						"linkedServiceName": {
							"referenceName": "SaraDB connection",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "WorkMilkProd Transfer",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "ID Updates_copy1",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlServerSink",
								"preCopyScript": "truncate table USDA.WorkMilkProd"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "GRPID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "GRPID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "CommodityID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "CommodityID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Class",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Class",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CatID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "CatID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "UnitID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "UnitID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Domain",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Domain",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "StateAnsi",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "StateAnsi",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "GeoID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "GeoID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Region",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Region",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "State",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "State",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WeekEnding",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "WeekEnding",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "PeriodID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PeriodID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "FreqID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PeriodTypeID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 18
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "NormValue",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										},
										"sink": {
											"name": "NormValue",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 18
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "USDAData",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "WorkMilkProd",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Milk Transformations",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "WorkMilkProd Transfer",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[USDA].[MilkProdTransform]"
						},
						"linkedServiceName": {
							"referenceName": "SaraDB connection",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Slaughter Pipeline')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Slaughter National Import",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:04:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET"
							},
							"sink": {
								"type": "SqlServerSink",
								"preCopyScript": "Truncate table USDA.USDADataFactory"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['region_desc']"
										},
										"sink": {
											"name": "Region",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['class_desc']"
										},
										"sink": {
											"name": "Class",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['state_ansi']"
										},
										"sink": {
											"name": "StateAnsi",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Value']"
										},
										"sink": {
											"name": "Value",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "Year",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['commodity_desc']"
										},
										"sink": {
											"name": "Commodity",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['short_desc']"
										},
										"sink": {
											"name": "ItemConcat",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['state_name']"
										},
										"sink": {
											"name": "State",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reference_period_desc']"
										},
										"sink": {
											"name": "Period",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['freq_desc']"
										},
										"sink": {
											"name": "Frequency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['util_practice_desc']"
										},
										"sink": {
											"name": "UtilPract",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['unit_desc']"
										},
										"sink": {
											"name": "Unit",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['prodn_practice_desc']"
										},
										"sink": {
											"name": "ProdPract",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['week_ending']"
										},
										"sink": {
											"name": "WeekEndingString",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['statisticcat_desc']"
										},
										"sink": {
											"name": "Category",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['domaincat_desc']"
										},
										"sink": {
											"name": "DomainCat",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['group_desc']"
										},
										"sink": {
											"name": "GRP",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['domain_desc']"
										},
										"sink": {
											"name": "Domain",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['data']"
							}
						},
						"inputs": [
							{
								"referenceName": "SlaughterNationalAPI",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DataFactoryTable",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy to USDAData",
						"description": "transfer from DataFactory to USDAData",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Slaughter National Import",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlServerSink",
								"preCopyScript": "delete from USDA.USDAdataFactory where category <>'SLAUGHTERED'\nupdate usda.usdadatafactory set weekending = cast(weekendingstring as date)\n\twhere weekendingstring <> ''and weekendingstring is not null\n\tupdate usda.usdadatafactory set value = replace(value,',','')\n\tupdate USDA.USDADataFactory set value = NULL where isnumeric(value) = 0\n\tupdate usda.usdadatafactory set valuedec = cast(value as decimal(18,0))\n\tupdate usda.usdadatafactory set stateansiint = cast(stateansi as int)\n\n\n\ttruncate table USDA.USDAData\n"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "GRP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "GRP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Commodity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Commodity",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Class",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Class",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Category",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Category",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Unit",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Domain",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Domain",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "StateAnsiInt",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "StateAnsi",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Region",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Region",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "State",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "State",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WeekEnding",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "WeekEnding",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Frequency",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Frequency",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Period",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Period",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PeriodID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PeriodID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Value",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "NormValue",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										},
										"sink": {
											"name": "NormValue",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "USDADataFactory",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "USDAData",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "ID Updates",
						"description": "Set the proper ids in USDADATA table",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy to USDAData",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[USDA].[UpdateIds]"
						},
						"linkedServiceName": {
							"referenceName": "SaraDB connection",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Work Slaughter Transfer",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "ID Updates",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlServerSink",
								"preCopyScript": "truncate table USDA.WorkSlaughter"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "GRPID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "GRPID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "CommodityID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "CommodityID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Class",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Class",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CatID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "CatID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "UnitID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "UnitID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Domain",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Domain",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "StateAnsi",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "StateAnsi",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "GeoID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "GeoID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Region",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Region",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "State",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "State",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WeekEnding",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "WeekEnding",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "FreqID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PeriodTypeID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "PeriodID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PeriodID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Period",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Period",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 18
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "NormValue",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										},
										"sink": {
											"name": "NormValue",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "USDAData",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SlaughterWorkTable",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Slaughter Data Transform",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Work Slaughter Transfer",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[USDA].[SlaughterTransform]"
						},
						"linkedServiceName": {
							"referenceName": "SaraDB connection",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Trade Pipeline')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Japan Blob",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "UK Blob",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "partner",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Partner",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "volume",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Volume",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "value_1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "unit",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "declarant",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Declarant",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "product",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ProductCde",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "productname",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Product",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "flow",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Flow",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "year",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "month",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Month",
											"type": "Int32",
											"physicalType": "int"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "JapanTrade",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "TradeData",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "UK Blob",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "AR Blob",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "partner",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Partner",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "volume",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Volume",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "value_1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "unit",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "declarant",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Declarant",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "product",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ProductCde",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "flow",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Flow",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "year",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "month",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Month",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "productname"
										},
										"sink": {
											"name": "Product",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "UKTrade",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "TradeData",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "AR Blob",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "AU Blob",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "partner",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Partner",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "volume",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Volume",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "value_1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "unit",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "declarant",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Declarant",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "product",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ProductCde",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "flow",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Flow",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "year",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "month",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Month",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "productname"
										},
										"sink": {
											"name": "Product",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "ARTrade",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "TradeData",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "AU Blob",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Belarus Blob",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "partner",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Partner",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "volume",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Volume",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "value_1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "unit",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "declarant",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Declarant",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "product",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ProductCde",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "flow",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Flow",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "year",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "month",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Month",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "productname"
										},
										"sink": {
											"name": "Product",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "AUTrade",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "TradeData",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Belarus Blob",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CN Blob",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "partner",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Partner",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "volume",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Volume",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "value_1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "unit",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "declarant",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Declarant",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "product",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ProductCde",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "flow",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Flow",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "year",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "month",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Month",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "productname"
										},
										"sink": {
											"name": "Product",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "BelarusTrade",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "TradeData",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "CN Blob",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "EU Blob",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "partner",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Partner",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "volume",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Volume",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "value_1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "unit",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "declarant",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Declarant",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "product",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ProductCde",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "flow",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Flow",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "year",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "month",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Month",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "productname"
										},
										"sink": {
											"name": "Product",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "CNTrade",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "TradeData",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "EU Blob",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "EU 27 Blob",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "partner",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Partner",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "volume",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Volume",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "value_1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "unit",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "declarant",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Declarant",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "product",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ProductCde",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "flow",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Flow",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "year",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "month",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Month",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "productname"
										},
										"sink": {
											"name": "Product",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EUTrade",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "TradeData",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "EU 27 Blob",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "MX Blob",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "partner",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Partner",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "volume",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Volume",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "value_1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "unit",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "declarant",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Declarant",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "product",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ProductCde",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "flow",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Flow",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "year",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "month",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Month",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "productname"
										},
										"sink": {
											"name": "Product",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "EU27Trade",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "TradeData",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "MX Blob",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "partner",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Partner",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "volume",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Volume",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "value_1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "unit",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "declarant",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Declarant",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "product",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ProductCde",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "flow",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Flow",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "year",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "month",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Month",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "productname"
										},
										"sink": {
											"name": "Product",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "MXTrade",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "TradeData",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "NZ Blob",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Japan Blob",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "partner",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Partner",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "volume",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Volume",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "value_1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "unit",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "declarant",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Declarant",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "product",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ProductCde",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "flow",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Flow",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "year",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "month",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Month",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "productname"
										},
										"sink": {
											"name": "Product",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "NZTrade",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "TradeData",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Russia Blob",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "NZ Blob",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "partner",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Partner",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "volume",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Volume",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "value_1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "unit",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "declarant",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Declarant",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "product",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ProductCde",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "flow",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Flow",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "year",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "month",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Month",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "productname"
										},
										"sink": {
											"name": "Product",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "RussiaTrade",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "TradeData",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "South Korea Blob",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Russia Blob",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "partner",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Partner",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "volume",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Volume",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "value_1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "unit",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "declarant",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Declarant",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "product",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ProductCde",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "flow",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Flow",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "year",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "month",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Month",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "productname"
										},
										"sink": {
											"name": "Product",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "SouthKoreTrade",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "TradeData",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "US Blob",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "South Korea Blob",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "partner",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Partner",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "volume",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Volume",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "value_1",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "unit",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "declarant",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Declarant",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "product",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "ProductCde",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "flow",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Flow",
											"type": "String",
											"physicalType": "nchar"
										}
									},
									{
										"source": {
											"name": "year",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "month",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Month",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "productname"
										},
										"sink": {
											"name": "Product",
											"type": "String",
											"physicalType": "nvarchar"
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "USTrade",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "TradeData",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Remove Nulls",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "US Blob",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[TRADE].[RemoveNulls]"
						},
						"linkedServiceName": {
							"referenceName": "Sara Database",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Trade Calculations",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[TRADE].[TradeConversions]"
						},
						"linkedServiceName": {
							"referenceName": "Sara Database",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/USDA 10 Year')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "Slaughter National Import",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET"
							},
							"sink": {
								"type": "SqlServerSink",
								"preCopyScript": "Truncate table USDA.USDADataFactory"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['region_desc']"
										},
										"sink": {
											"name": "Region",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['class_desc']"
										},
										"sink": {
											"name": "Class",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['state_ansi']"
										},
										"sink": {
											"name": "StateAnsi",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Value']"
										},
										"sink": {
											"name": "Value",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "Year",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['commodity_desc']"
										},
										"sink": {
											"name": "Commodity",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['short_desc']"
										},
										"sink": {
											"name": "ItemConcat",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['state_name']"
										},
										"sink": {
											"name": "State",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reference_period_desc']"
										},
										"sink": {
											"name": "Period",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['freq_desc']"
										},
										"sink": {
											"name": "Frequency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['util_practice_desc']"
										},
										"sink": {
											"name": "UtilPract",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['unit_desc']"
										},
										"sink": {
											"name": "Unit",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['prodn_practice_desc']"
										},
										"sink": {
											"name": "ProdPract",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['week_ending']"
										},
										"sink": {
											"name": "WeekEndingString",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['statisticcat_desc']"
										},
										"sink": {
											"name": "Category",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['domaincat_desc']"
										},
										"sink": {
											"name": "DomainCat",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['group_desc']"
										},
										"sink": {
											"name": "GRP",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['domain_desc']"
										},
										"sink": {
											"name": "Domain",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['data']"
							}
						},
						"inputs": [
							{
								"referenceName": "SlaughterNationalAPI",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DataFactoryTable",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Slaughter Regional Import",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Slaughter National Import",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:01:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET"
							},
							"sink": {
								"type": "SqlServerSink",
								"preCopyScript": "delete from USDA.USDAdataFactory where category <>'SLAUGHTERED'"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['region_desc']"
										},
										"sink": {
											"name": "Region",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reference_period_desc']"
										},
										"sink": {
											"name": "Period",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['statisticcat_desc']"
										},
										"sink": {
											"name": "Category",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['domaincat_desc']"
										},
										"sink": {
											"name": "DomainCat",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Value']"
										},
										"sink": {
											"name": "Value",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['freq_desc']"
										},
										"sink": {
											"name": "Frequency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['util_practice_desc']"
										},
										"sink": {
											"name": "UtilPract",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['state_ansi']"
										},
										"sink": {
											"name": "StateAnsi",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['prodn_practice_desc']"
										},
										"sink": {
											"name": "ProdPract",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['short_desc']"
										},
										"sink": {
											"name": "ItemConcat",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['unit_desc']"
										},
										"sink": {
											"name": "Unit",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['class_desc']"
										},
										"sink": {
											"name": "Class",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['commodity_desc']"
										},
										"sink": {
											"name": "Commodity",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "Year",
											"type": "Int32"
										}
									},
									{
										"source": {
											"path": "[['domain_desc']"
										},
										"sink": {
											"name": "Domain",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['state_name']"
										},
										"sink": {
											"name": "State",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['group_desc']"
										},
										"sink": {
											"name": "GRP",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['week_ending']"
										},
										"sink": {
											"name": "WeekEndingString",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['data']"
							}
						},
						"inputs": [
							{
								"referenceName": "SlaughterRegionalAPI",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DataFactoryTable",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Copy to USDAData",
						"description": "transfer from DataFactory to USDAData",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "Slaughter Regional Import",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlServerSink",
								"preCopyScript": "update usda.usdadatafactory set weekending = cast(weekendingstring as date)\n\twhere weekendingstring <> ''and weekendingstring is not null\n\tupdate usda.usdadatafactory set value = replace(value,',','')\n\tupdate USDA.USDADataFactory set value = NULL where isnumeric(value) = 0\n\tupdate usda.usdadatafactory set valuedec = cast(value as decimal(18,0))\n\tupdate usda.usdadatafactory set stateansiint = cast(stateansi as int)\n\n\n\ttruncate table USDA.USDAData\n"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "GRP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "GRP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Commodity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Commodity",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Class",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Class",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Category",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Category",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Unit",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Domain",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Domain",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "StateAnsiInt",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "StateAnsi",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Region",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Region",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "State",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "State",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WeekEnding",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "WeekEnding",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Frequency",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Frequency",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Period",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Period",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PeriodID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PeriodID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Value",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "NormValue",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										},
										"sink": {
											"name": "NormValue",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "USDADataFactory",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "USDAData",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "ID Updates",
						"description": "Set the proper ids in USDADATA table",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy to USDAData",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[USDA].[UpdateIds]"
						},
						"linkedServiceName": {
							"referenceName": "SaraDB connection",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Work Slaughter Transfer",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "ID Updates",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlServerSink",
								"preCopyScript": "truncate table USDA.WorkSlaughter"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "GRPID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "GRPID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "CommodityID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "CommodityID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Class",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Class",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CatID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "CatID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "UnitID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "UnitID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Domain",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Domain",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "StateAnsi",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "StateAnsi",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "GeoID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "GeoID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Region",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Region",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "State",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "State",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WeekEnding",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "WeekEnding",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "FreqID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PeriodTypeID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "PeriodID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PeriodID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Period",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Period",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 18
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "NormValue",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										},
										"sink": {
											"name": "NormValue",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "USDAData",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "SlaughterWorkTable",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/USDA DAIRY PIPELINE')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"description": "Import dairy stocks using rest api",
				"activities": [
					{
						"name": "CopyDairyStocks",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Destination",
								"value": "USDA.USDADataFactory"
							}
						],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:04:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET"
							},
							"sink": {
								"type": "SqlServerSink",
								"preCopyScript": "truncate table USDA.USDADataFactory\n",
								"writeBehavior": "insert"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['week_ending']"
										},
										"sink": {
											"name": "WeekEndingString",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "Year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['util_practice_desc']"
										},
										"sink": {
											"name": "UtilPract",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['class_desc']"
										},
										"sink": {
											"name": "Class",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['group_desc']"
										},
										"sink": {
											"name": "GRP",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['short_desc']"
										},
										"sink": {
											"name": "ItemConcat",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['statisticcat_desc']"
										},
										"sink": {
											"name": "Category",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reference_period_desc']"
										},
										"sink": {
											"name": "Period",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Value']"
										},
										"sink": {
											"name": "Value",
											"type": "Decimal"
										}
									},
									{
										"source": {
											"path": "[['state_name']"
										},
										"sink": {
											"name": "State",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['freq_desc']"
										},
										"sink": {
											"name": "Frequency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['domain_desc']"
										},
										"sink": {
											"name": "Domain",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['state_ansi']"
										},
										"sink": {
											"name": "StateAnsi",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['commodity_desc']"
										},
										"sink": {
											"name": "Commodity",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['prodn_practice_desc']"
										},
										"sink": {
											"name": "ProdPract",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['domaincat_desc']"
										},
										"sink": {
											"name": "DomainCat",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['unit_desc']"
										},
										"sink": {
											"name": "Unit",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['region_desc']"
										},
										"sink": {
											"name": "Region",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['data']"
							}
						},
						"inputs": [
							{
								"referenceName": "10YearStocks",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DataFactoryTable",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "CopyDairyProduction",
						"description": "dairy production api\n",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CopyDairyStocks",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "RestSource",
								"httpRequestTimeout": "00:04:40",
								"requestInterval": "00.00:00:00.010",
								"requestMethod": "GET"
							},
							"sink": {
								"type": "SqlServerSink",
								"writeBehavior": "insert"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"path": "[['prodn_practice_desc']"
										},
										"sink": {
											"name": "ProdPract",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['state_ansi']"
										},
										"sink": {
											"name": "StateAnsi",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['domain_desc']"
										},
										"sink": {
											"name": "Domain",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['util_practice_desc']"
										},
										"sink": {
											"name": "UtilPract",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['commodity_desc']"
										},
										"sink": {
											"name": "Commodity",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['group_desc']"
										},
										"sink": {
											"name": "GRP",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['unit_desc']"
										},
										"sink": {
											"name": "Unit",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['year']"
										},
										"sink": {
											"name": "Year",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['freq_desc']"
										},
										"sink": {
											"name": "Frequency",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['statisticcat_desc']"
										},
										"sink": {
											"name": "Category",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['short_desc']"
										},
										"sink": {
											"name": "ItemConcat",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['reference_period_desc']"
										},
										"sink": {
											"name": "Period",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['class_desc']"
										},
										"sink": {
											"name": "Class",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['region_desc']"
										},
										"sink": {
											"name": "Region",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['state_name']"
										},
										"sink": {
											"name": "State",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['domaincat_desc']"
										},
										"sink": {
											"name": "DomainCat",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['week_ending']"
										},
										"sink": {
											"name": "WeekEndingString",
											"type": "String"
										}
									},
									{
										"source": {
											"path": "[['Value']"
										},
										"sink": {
											"name": "Value",
											"type": "String"
										}
									}
								],
								"collectionReference": "$['data']"
							}
						},
						"inputs": [
							{
								"referenceName": "10YearDairyProd",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DataFactoryTable",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "ID Updates",
						"description": "Set the proper ids in USDADATA table",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Copy to USDAData",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[USDA].[UpdateIds]"
						},
						"linkedServiceName": {
							"referenceName": "SaraDB connection",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Work Table Transfer",
						"description": "Transfer data to workDairy table",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "ID Updates",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlServerSink",
								"preCopyScript": "\ntruncate table usda.workDairyProd",
								"writeBehavior": "insert"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "GRPID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "GRPID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "CommodityID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "CommodityID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Class",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Class",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "CatID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "CatID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "UnitID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "UnitID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Domain",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Domain",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "StateAnsi",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "StateAnsi",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "GeoID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "GeoID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Region",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Region",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "State",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "State",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "WeekEnding",
											"type": "DateTime",
											"physicalType": "date"
										},
										"sink": {
											"name": "WeekEnding",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Period",
											"type": "String",
											"physicalType": "nvarchar"
										},
										"sink": {
											"name": "Period",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "PeriodID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PeriodID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "FreqID",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "PeriodTypeID",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "NormValue",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										},
										"sink": {
											"name": "NormValue",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 18
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 18
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "USDAData",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "WorkDairyProd",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Dairy Transformations",
						"description": "Executes 4 procedures to deal with all dairy calculations and queries",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Work Table Transfer",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[USDA].[DairyProcedure]"
						},
						"linkedServiceName": {
							"referenceName": "SaraDB connection",
							"type": "LinkedServiceReference"
						}
					},
					{
						"name": "Copy to USDAData",
						"description": "transfer from DataFactory to USDAData",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "CopyDairyProduction",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "SqlServerSource",
								"queryTimeout": "02:00:00",
								"partitionOption": "None"
							},
							"sink": {
								"type": "SqlServerSink",
								"preCopyScript": "update usda.usdadatafactory set weekending = cast(weekendingstring as date)\n\twhere weekending <> ''\n\tupdate usda.usdadatafactory set value = replace(value,',','')\n\tupdate USDA.USDADataFactory set value = NULL where isnumeric(value) = 0\n\tupdate usda.usdadatafactory set valuedec = cast(value as decimal(18,0))\n\tupdate usda.usdadatafactory set stateansiint = cast(stateansi as int)\n\ntruncate table usda.usdadata\n\n\n\n\n",
								"writeBehavior": "insert"
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "GRP",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "GRP",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Commodity",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Commodity",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "UtilPract",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Class",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Class",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ProdPract",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Category",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Category",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Unit",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Unit",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Domain",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Domain",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "DomainCat",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "ItemConcat",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "StateAnsiInt",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "StateAnsi",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Region",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Region",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "State",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "State",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Frequency",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Frequency",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Period",
											"type": "String",
											"physicalType": "varchar"
										},
										"sink": {
											"name": "Period",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "ValueDec",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 0,
											"precision": 18
										},
										"sink": {
											"name": "Value",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 18
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "USDADataFactory",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "USDAData",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/Xchange Pipeline')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "trigger logic",
						"type": "WebActivity",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"url": "https://prod-81.westus.logic.azure.com:443/workflows/698a50a012c24d82ac7eb1e0f3bf17bb/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=uGL7WkC3-T_TZU54M9xXBILgT6GQp2d-GAltobux_3I",
							"method": "GET",
							"headers": {},
							"body": "https://prod-81.westus.logic.azure.com:443/workflows/698a50a012c24d82ac7eb1e0f3bf17bb/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=uGL7WkC3-T_TZU54M9xXBILgT6GQp2d-GAltobux_3I"
						}
					},
					{
						"name": "Xrate Blob Transfer",
						"type": "Copy",
						"dependsOn": [
							{
								"activity": "trigger logic",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table xrateimport",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Date",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Date",
											"type": "DateTime",
											"physicalType": "date"
										}
									},
									{
										"source": {
											"name": "Euro   (EUR)                     ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Euro_USD",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 6,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "Polish Zloty (PLN)",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "PLN_USD",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 6,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "New Zealand dollar   (NZD)                     ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "NZD_USD",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 6,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "Australian dollar   (AUD)                     ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "AUD_USD",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 6,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "Mexican peso   (MXN)                     ",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "MXN_USD",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 6,
											"precision": 18
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "Xrate",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "XrateImport",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "import rates",
						"description": "enters imported rates into proper table",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [
							{
								"activity": "Xrate Blob Transfer",
								"dependencyConditions": [
									"Succeeded"
								]
							}
						],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[ImportRates]"
						},
						"linkedServiceName": {
							"referenceName": "Sara Database",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('factoryName'), '/pipeline1')]",
			"type": "Microsoft.DataFactory/factories/pipelines",
			"apiVersion": "2018-06-01",
			"properties": {
				"activities": [
					{
						"name": "FuturesBlob",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"source": {
								"type": "ExcelSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"enablePartitionDiscovery": false
								}
							},
							"sink": {
								"type": "AzureSqlSink",
								"preCopyScript": "truncate table futuresimp\n",
								"writeBehavior": "insert",
								"sqlWriterUseTableLock": false,
								"tableOption": "autoCreate",
								"disableMetricsCollection": false
							},
							"enableStaging": false,
							"translator": {
								"type": "TabularTranslator",
								"mappings": [
									{
										"source": {
											"name": "Contract",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Contract",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Description",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Description",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Source",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Source",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Month",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Month",
											"type": "String",
											"physicalType": "nvarchar"
										}
									},
									{
										"source": {
											"name": "Year",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Year",
											"type": "Int32",
											"physicalType": "int"
										}
									},
									{
										"source": {
											"name": "Price",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "Price",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 2,
											"precision": 18
										}
									},
									{
										"source": {
											"name": "Price_Lb",
											"type": "String",
											"physicalType": "String"
										},
										"sink": {
											"name": "PriceLb",
											"type": "Decimal",
											"physicalType": "decimal",
											"scale": 5,
											"precision": 18
										}
									}
								],
								"typeConversion": true,
								"typeConversionSettings": {
									"allowDataTruncation": true,
									"treatBooleanAsNumber": false
								}
							}
						},
						"inputs": [
							{
								"referenceName": "FuturesBlob",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "FuturesImp",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					},
					{
						"name": "Futures LogicApp WebHook",
						"type": "WebHook",
						"dependsOn": [],
						"userProperties": [],
						"typeProperties": {
							"url": "https://prod-15.westus.logic.azure.com:443/workflows/dbe0895afdca41918cc5a002c1a2c138/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=vJPcVEvH6olmcdFW8O9tCBccc2i0JpNAom4qYNzEpBw",
							"method": "POST",
							"headers": {
								"Content-Type": "application/json"
							},
							"body": {
								"DataFactoryName": "@{pipeline().DataFactory}",
								"PipelineName": "@{pipeline().Pipeline}"
							},
							"timeout": "00:10:00"
						}
					},
					{
						"name": "FuturesCalcs",
						"type": "SqlServerStoredProcedure",
						"dependsOn": [],
						"policy": {
							"timeout": "0.12:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [],
						"typeProperties": {
							"storedProcedureName": "[[dbo].[FuturesProcedure]"
						},
						"linkedServiceName": {
							"referenceName": "Sara Database",
							"type": "LinkedServiceReference"
						}
					}
				],
				"policy": {
					"elapsedTimeMetric": {},
					"cancelAfter": {}
				},
				"annotations": []
			},
			"dependsOn": []
		}
	]
}